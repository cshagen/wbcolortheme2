{"version":3,"file":"css/SystemConfig.0623275a.css","mappings":"AAmkBA,kCACC,iBAAkB,CAClB,gBACD","sources":["webpack://openwb-ui-settings/./src/views/System.vue"],"sourcesContent":["<template>\n\t<div class=\"power\">\n\t\t<openwb-base-alert subtype=\"danger\">\n\t\t\t<h2>Achtung!</h2>\n\t\t\t<p>\n\t\t\t\tVor allen Aktionen auf dieser Seite ist sicherzustellen, dass\n\t\t\t\tkein Ladevorgang aktiv ist! Zur Sicherheit bitte zusätzlich alle\n\t\t\t\tFahrzeuge von der Ladestation / den Ladestationen abstecken!\n\t\t\t</p>\n\t\t\t<openwb-base-button-group-input\n\t\t\t\ttitle=\"Ich habe die Warnung verstanden\"\n\t\t\t\t:buttons=\"[\n\t\t\t\t\t{\n\t\t\t\t\t\tbuttonValue: false,\n\t\t\t\t\t\ttext: 'Nein',\n\t\t\t\t\t\tclass: 'btn-outline-danger',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tbuttonValue: true,\n\t\t\t\t\t\ttext: 'Ja',\n\t\t\t\t\t\tclass: 'btn-outline-success',\n\t\t\t\t\t},\n\t\t\t\t]\"\n\t\t\t\tv-model=\"this.warningAcknowledged\"\n\t\t\t/>\n\t\t</openwb-base-alert>\n\t\t<div v-if=\"warningAcknowledged\">\n\t\t\t<form name=\"versionInfoForm\">\n\t\t\t\t<openwb-base-card title=\"Versions-Informationen\">\n\t\t\t\t\t<openwb-base-text-input\n\t\t\t\t\t\ttitle=\"Entwicklungszweig\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t\tv-model=\"\n\t\t\t\t\t\t\t$store.state.mqtt['openWB/system/current_branch']\n\t\t\t\t\t\t\"\n\t\t\t\t\t/>\n\t\t\t\t\t<openwb-base-text-input\n\t\t\t\t\t\ttitle=\"installierte Version\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t\t:class=\"\n\t\t\t\t\t\t\tupdateAvailable ? 'text-danger' : 'text-success'\n\t\t\t\t\t\t\"\n\t\t\t\t\t\tv-model=\"\n\t\t\t\t\t\t\t$store.state.mqtt['openWB/system/current_commit']\n\t\t\t\t\t\t\"\n\t\t\t\t\t/>\n\t\t\t\t\t<openwb-base-text-input\n\t\t\t\t\t\ttitle=\"aktuellste Version\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t\tv-model=\"\n\t\t\t\t\t\t\t$store.state.mqtt[\n\t\t\t\t\t\t\t\t'openWB/system/current_branch_commit'\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\"\n\t\t\t\t\t/>\n\t\t\t\t\t<openwb-base-card\n\t\t\t\t\t\tv-if=\"updateAvailable\"\n\t\t\t\t\t\ttitle=\"Änderungen\"\n\t\t\t\t\t\tsubtype=\"info\"\n\t\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ul class=\"missing-commits\">\n\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\tv-for=\"(commit, key) in $store.state.mqtt[\n\t\t\t\t\t\t\t\t\t'openWB/system/current_missing_commits'\n\t\t\t\t\t\t\t\t]\"\n\t\t\t\t\t\t\t\t:key=\"key\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ commit }}\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</openwb-base-card>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"row justify-content-center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"col-md-4 d-flex py-1 justify-content-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\tclass=\"btn-success\"\n\t\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t\tsendSystemCommand('systemFetchVersions')\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tInformationen aktualisieren\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'download']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!-- <openwb-base-submit-buttons\n\t\t\t\t\t\t\tformName=\"versionInfoForm\"\n\t\t\t\t\t\t\t@save=\"$emit('save')\"\n\t\t\t\t\t\t\t@reset=\"$emit('reset')\"\n\t\t\t\t\t\t\t@defaults=\"$emit('defaults')\"\n\t\t\t\t\t\t/> -->\n\t\t\t\t\t</template>\n\t\t\t\t</openwb-base-card>\n\t\t\t</form>\n\t\t\t<form name=\"updateForm\">\n\t\t\t\t<openwb-base-card\n\t\t\t\t\ttitle=\"Aktualisierung\"\n\t\t\t\t\tsubtype=\"success\"\n\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<openwb-base-alert subtype=\"danger\">\n\t\t\t\t\t\tNach einem Update wird die Ladestation direkt neu\n\t\t\t\t\t\tgestartet! Es werden alle lokalen Änderungen mit dem\n\t\t\t\t\t\tUpdate verworfen!\n\t\t\t\t\t</openwb-base-alert>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"row justify-content-center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"col-md-4 d-flex py-1 justify-content-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\t:class=\"\n\t\t\t\t\t\t\t\t\t\tupdateAvailable\n\t\t\t\t\t\t\t\t\t\t\t? 'btn-success clickable'\n\t\t\t\t\t\t\t\t\t\t\t: 'btn-outline-success'\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t\t:disabled=\"!updateAvailable\"\n\t\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t\tsendSystemCommand('systemUpdate', {})\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tUpdate\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'arrow-alt-circle-up']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</openwb-base-card>\n\t\t\t</form>\n\t\t\t<form name=\"releaseChangeForm\">\n\t\t\t\t<openwb-base-card\n\t\t\t\t\ttitle=\"Entwicklungszweig\"\n\t\t\t\t\tsubtype=\"danger\"\n\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<openwb-base-alert subtype=\"danger\">\n\t\t\t\t\t\tNach einem Wechsel wird die Ladestation direkt neu\n\t\t\t\t\t\tgestartet! Es werden alle lokalen Änderungen mit dem\n\t\t\t\t\t\tWechsel verworfen!\n\t\t\t\t\t</openwb-base-alert>\n\t\t\t\t\t<openwb-base-alert subtype=\"warning\">\n\t\t\t\t\t\tDas ist eine experimentelle Option! Verwendung auf\n\t\t\t\t\t\teigene Gefahr. Im schlimmsten Fall muss das system neu\n\t\t\t\t\t\tinstalliert werden!<br />\n\t\t\t\t\t\tToDo:\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>do not allow downgrade</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</openwb-base-alert>\n\t\t\t\t\t<openwb-base-select-input\n\t\t\t\t\t\ttitle=\"Entwicklungszweig\"\n\t\t\t\t\t\t:options=\"getBranchOptions()\"\n\t\t\t\t\t\t:model-value=\"\n\t\t\t\t\t\t\t$store.state.mqtt['openWB/system/current_branch']\n\t\t\t\t\t\t\"\n\t\t\t\t\t\t@update:model-value=\"\n\t\t\t\t\t\t\tupdateState('openWB/system/current_branch', $event)\n\t\t\t\t\t\t\"\n\t\t\t\t\t/>\n\t\t\t\t\t<openwb-base-select-input\n\t\t\t\t\t\ttitle=\"Tag\"\n\t\t\t\t\t\t:options=\"getBranchTagOptions()\"\n\t\t\t\t\t\tv-model=\"selectedTag\"\n\t\t\t\t\t/>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"row justify-content-center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"col-md-4 d-flex py-1 justify-content-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\tclass=\"btn-danger clickable\"\n\t\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t\tsendSystemCommand('systemUpdate', {\n\t\t\t\t\t\t\t\t\t\t\tbranch: $store.state.mqtt[\n\t\t\t\t\t\t\t\t\t\t\t\t'openWB/system/current_branch'\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t\ttag: selectedTag,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'skull-crossbones']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\tBranch und Tag wechseln\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'skull-crossbones']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</openwb-base-card>\n\t\t\t</form>\n\t\t\t<form name=\"backupForm\">\n\t\t\t\t<openwb-base-card\n\t\t\t\t\ttitle=\"Sicherung\"\n\t\t\t\t\tsubtype=\"success\"\n\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<openwb-base-alert subtype=\"info\">\n\t\t\t\t\t\tNachdem die Sicherung abgeschlossen ist, kann die\n\t\t\t\t\t\terstellte Datei über den Link in der Benachrichtigung\n\t\t\t\t\t\toder\n\t\t\t\t\t\t<a href=\"/openWB/data/backup/\" target=\"_blank\">hier</a>\n\t\t\t\t\t\theruntergeladen werden.\n\t\t\t\t\t</openwb-base-alert>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"row justify-content-center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"col-md-4 d-flex py-1 justify-content-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\tclass=\"btn-success clickable\"\n\t\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t\tsendSystemCommand('createBackup', {\n\t\t\t\t\t\t\t\t\t\t\tuse_extended_filename: true,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tSicherung erstellen\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'archive']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</openwb-base-card>\n\t\t\t</form>\n\t\t\t<form name=\"restoreForm\">\n\t\t\t\t<openwb-base-card\n\t\t\t\t\ttitle=\"Wiederherstellung\"\n\t\t\t\t\tsubtype=\"success\"\n\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<openwb-base-alert subtype=\"danger\">\n\t\t\t\t\t\tDiese Funktion ist noch in Entwicklung! Es kann\n\t\t\t\t\t\tpotentiell das System unbrauchbar werden. Nach\n\t\t\t\t\t\tMöglichkeit vorher ein Image der Installation\n\t\t\t\t\t\terstellen!<br />\n\t\t\t\t\t\tFür die Wiederherstellung wird eine aktive\n\t\t\t\t\t\tInternetverbindung benötigt.\n\t\t\t\t\t</openwb-base-alert>\n\t\t\t\t\t<div class=\"input-group\">\n\t\t\t\t\t\t<div class=\"input-group-prepend\">\n\t\t\t\t\t\t\t<div class=\"input-group-text\">\n\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'file-archive']\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"custom-file\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tid=\"input-file\"\n\t\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\t\tclass=\"custom-file-input\"\n\t\t\t\t\t\t\t\taccept=\".tar.gz,application/gzip,application/tar+gzip\"\n\t\t\t\t\t\t\t\t@change=\"updateSelectedFile($event)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\tid=\"input-file-label\"\n\t\t\t\t\t\t\t\tclass=\"custom-file-label\"\n\t\t\t\t\t\t\t\tfor=\"input-file\"\n\t\t\t\t\t\t\t\tdata-browse=\"Suchen\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\tselectedFile\n\t\t\t\t\t\t\t\t\t\t? selectedFile.name\n\t\t\t\t\t\t\t\t\t\t: \"Bitte eine Datei auswählen\"\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"input-group-append\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"btn\"\n\t\t\t\t\t\t\t\t:class=\"\n\t\t\t\t\t\t\t\t\tselectedFile\n\t\t\t\t\t\t\t\t\t\t? 'btn-success clickable'\n\t\t\t\t\t\t\t\t\t\t: 'btn-outline-success'\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t:disabled=\"!selectedFile\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t@click=\"uploadFile()\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tHochladen\n\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'upload']\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"row justify-content-center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"col-md-4 d-flex py-1 justify-content-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\t:class=\"\n\t\t\t\t\t\t\t\t\t\trestoreUploadDone\n\t\t\t\t\t\t\t\t\t\t\t? 'btn-success clickable'\n\t\t\t\t\t\t\t\t\t\t\t: 'btn-outline-success'\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t\t:disabled=\"!restoreUploadDone\"\n\t\t\t\t\t\t\t\t\t@click=\"sendSystemCommand('restoreBackup')\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tWiederherstellung starten\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'box-open']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</openwb-base-card>\n\t\t\t</form>\n\t\t\t<form name=\"powerForm\">\n\t\t\t\t<openwb-base-card\n\t\t\t\t\ttitle=\"Betrieb\"\n\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<openwb-base-alert subtype=\"danger\">\n\t\t\t\t\t\tWenn die Ladestation ausgeschaltet wird, muss sie\n\t\t\t\t\t\tkomplett spannungsfrei geschaltet werden. Erst beim\n\t\t\t\t\t\terneuten Zuschalten der Spannung fährt das System wieder\n\t\t\t\t\t\thoch.\n\t\t\t\t\t</openwb-base-alert>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<div class=\"row justify-content-center\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"col-md-4 d-flex py-1 justify-content-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\tclass=\"btn-warning\"\n\t\t\t\t\t\t\t\t\t@click=\"sendSystemCommand('systemReboot')\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tNeustart\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'undo']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"col-md-4 d-flex py-1 justify-content-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\tclass=\"btn-danger\"\n\t\t\t\t\t\t\t\t\t@click=\"sendSystemCommand('systemShutdown')\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tAusschalten\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'power-off']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</openwb-base-card>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport {\n\tfaArrowAltCircleUp as fasArrowAltCircleUp,\n\tfaUndo as fasUndo,\n\tfaPowerOff as fasPowerOff,\n\tfaDownload as fasDownload,\n\tfaSkullCrossbones as fasSkullCrossbones,\n\tfaArchive as fasArchive,\n\tfaFileArchive as fasFileArchive,\n\tfaUpload as fasUpload,\n\tfaBoxOpen as fasBoxOpen,\n} from \"@fortawesome/free-solid-svg-icons\";\nlibrary.add(\n\tfasArrowAltCircleUp,\n\tfasUndo,\n\tfasPowerOff,\n\tfasDownload,\n\tfasSkullCrossbones,\n\tfasArchive,\n\tfasFileArchive,\n\tfasUpload,\n\tfasBoxOpen\n);\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\n\nimport ComponentStateMixin from \"@/components/mixins/ComponentState.vue\";\n\nexport default {\n\tname: \"OpenwbSystem\",\n\tmixins: [ComponentStateMixin],\n\temits: [\"sendCommand\"],\n\tcomponents: {\n\t\tFontAwesomeIcon,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tmqttTopicsToSubscribe: [\n\t\t\t\t\"openWB/system/current_commit\",\n\t\t\t\t\"openWB/system/current_branch_commit\",\n\t\t\t\t\"openWB/system/current_missing_commits\",\n\t\t\t\t\"openWB/system/available_branches\",\n\t\t\t\t\"openWB/system/current_branch\",\n\t\t\t],\n\t\t\twarningAcknowledged: false,\n\t\t\tselectedTag: \"*HEAD*\",\n\t\t\tselectedFile: undefined,\n\t\t\trestoreUploadDone: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tupdateAvailable() {\n\t\t\treturn (\n\t\t\t\tthis.$store.state.mqtt[\"openWB/system/current_branch_commit\"] &&\n\t\t\t\tthis.$store.state.mqtt[\"openWB/system/current_branch_commit\"] !=\n\t\t\t\t\tthis.$store.state.mqtt[\"openWB/system/current_commit\"]\n\t\t\t);\n\t\t},\n\t},\n\tmethods: {\n\t\tsendSystemCommand(command, data = {}) {\n\t\t\tthis.$emit(\"sendCommand\", {\n\t\t\t\tcommand: command,\n\t\t\t\tdata: data,\n\t\t\t});\n\t\t},\n\t\tgetBranchOptions() {\n\t\t\tvar source =\n\t\t\t\tthis.$store.state.mqtt[\"openWB/system/available_branches\"];\n\t\t\tvar options = [];\n\t\t\tif (source !== undefined) {\n\t\t\t\tfor (const [key, value] of Object.entries(source)) {\n\t\t\t\t\toptions.push({\n\t\t\t\t\t\tvalue: key,\n\t\t\t\t\t\ttext: key + \" (\" + value.commit + \")\",\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t},\n\t\tgetBranchTagOptions() {\n\t\t\tvar source =\n\t\t\t\tthis.$store.state.mqtt[\"openWB/system/available_branches\"][\n\t\t\t\t\tthis.$store.state.mqtt[\"openWB/system/current_branch\"]\n\t\t\t\t][\"tags\"];\n\t\t\tvar options = [];\n\t\t\tif (source !== undefined) {\n\t\t\t\tfor (const [key, value] of Object.entries(source)) {\n\t\t\t\t\toptions.unshift({\n\t\t\t\t\t\tvalue: key,\n\t\t\t\t\t\ttext: value,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\toptions.unshift({\n\t\t\t\tvalue: \"*HEAD*\",\n\t\t\t\ttext: \"Aktuellster Stand\",\n\t\t\t});\n\t\t\treturn options;\n\t\t},\n\t\tupdateSelectedFile(event) {\n\t\t\tthis.selectedFile = event.target.files[0];\n\t\t\tconsole.log(\"selectedFile\", this.selectedFile);\n\t\t},\n\t\tuploadFile() {\n\t\t\tif (this.selectedFile !== undefined) {\n\t\t\t\tlet formData = new FormData();\n\t\t\t\tformData.append(\"backupFile\", this.selectedFile);\n\t\t\t\tthis.axios\n\t\t\t\t\t.post(\n\t\t\t\t\t\tlocation.protocol +\n\t\t\t\t\t\t\t\"//\" +\n\t\t\t\t\t\t\tlocation.host +\n\t\t\t\t\t\t\t\"/openWB/web/settings/uploadBackup.php\",\n\t\t\t\t\t\tformData,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\"Content-Type\": \"multipart/form-data\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tconsole.log(\"POST response\", response.data);\n\t\t\t\t\t\tconst successMessage =\n\t\t\t\t\t\t\t\"Die Sicherungsdatei wurde erfolgreich hochgeladen. \" +\n\t\t\t\t\t\t\t\"Sie können die Wiederherstellung jetzt starten.\";\n\t\t\t\t\t\tconst timestamp = Math.floor(Date.now() / 1000);\n\t\t\t\t\t\tthis.$store.commit(\"addTopic\", {\n\t\t\t\t\t\t\ttopic:\n\t\t\t\t\t\t\t\t\"openWB/command/\" +\n\t\t\t\t\t\t\t\tthis.$root.mqttClientId +\n\t\t\t\t\t\t\t\t\"/messages/\" +\n\t\t\t\t\t\t\t\ttimestamp,\n\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\tsource: \"command\",\n\t\t\t\t\t\t\t\ttype: \"success\",\n\t\t\t\t\t\t\t\tmessage: successMessage,\n\t\t\t\t\t\t\t\ttimestamp: timestamp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.restoreUploadDone = true;\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\tvar alertMessage =\n\t\t\t\t\t\t\t\"Hochladen der Datei fehlgeschlagen!<br />\";\n\t\t\t\t\t\tif (error.response) {\n\t\t\t\t\t\t\t// The request was made and the server responded with a status code\n\t\t\t\t\t\t\t// that falls out of the range of 2xx\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\terror.response.status,\n\t\t\t\t\t\t\t\terror.response.data\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\talertMessage +=\n\t\t\t\t\t\t\t\terror.response.status +\n\t\t\t\t\t\t\t\t\": \" +\n\t\t\t\t\t\t\t\terror.response.data;\n\t\t\t\t\t\t} else if (error.request) {\n\t\t\t\t\t\t\t// The request was made but no response was received\n\t\t\t\t\t\t\t// `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n\t\t\t\t\t\t\t// http.ClientRequest in node.js\n\t\t\t\t\t\t\tconsole.log(error.request);\n\t\t\t\t\t\t\talertMessage +=\n\t\t\t\t\t\t\t\t\"Es wurde keine Antwort vom Server empfangen.\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Something happened in setting up the request that triggered an Error\n\t\t\t\t\t\t\tconsole.log(\"Error\", error.message);\n\t\t\t\t\t\t\talertMessage +=\n\t\t\t\t\t\t\t\t\"Es ist ein unbekannter Fehler aufgetreten.\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst timestamp = Math.floor(Date.now() / 1000);\n\t\t\t\t\t\tthis.$store.commit(\"addTopic\", {\n\t\t\t\t\t\t\ttopic:\n\t\t\t\t\t\t\t\t\"openWB/command/\" +\n\t\t\t\t\t\t\t\tthis.$root.mqttClientId +\n\t\t\t\t\t\t\t\t\"/messages/\" +\n\t\t\t\t\t\t\t\ttimestamp,\n\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\tsource: \"command\",\n\t\t\t\t\t\t\t\ttype: \"danger\",\n\t\t\t\t\t\t\t\tmessage: alertMessage,\n\t\t\t\t\t\t\t\ttimestamp: timestamp,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.restoreUploadDone = false;\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.error(\"no file selected for upload\");\n\t\t\t}\n\t\t},\n\t},\n};\n</script>\n\n<style scoped>\n.missing-commits {\n\toverflow-y: scroll;\n\tmax-height: 20rem;\n}\n</style>\n"],"names":[],"sourceRoot":""}