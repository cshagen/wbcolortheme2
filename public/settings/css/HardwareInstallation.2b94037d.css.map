{"version":3,"file":"css/HardwareInstallation.2b94037d.css","mappings":"AAgZA,4BACC,cACD","sources":["webpack://openwb-ui-settings/./src/views/HardwareInstallation.vue"],"sourcesContent":["<template>\n\t<!-- modal dialogs -->\n\t<openwb-base-modal-dialog\n\t\t:show=\"showDeviceRemoveModal\"\n\t\ttitle=\"Gerät löschen\"\n\t\tsubtype=\"danger\"\n\t\t:buttons=\"[{ text: 'Löschen', event: 'confirm', subtype: 'danger' }]\"\n\t\t@modal-result=\"removeDevice\"\n\t>\n\t\tWollen Sie das Gerät \"{{ modalDeviceName }}\" inklusive aller Komponenten\n\t\twirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden!\n\t</openwb-base-modal-dialog>\n\t<openwb-base-modal-dialog\n\t\t:show=\"showComponentRemoveModal\"\n\t\ttitle=\"Komponente löschen\"\n\t\tsubtype=\"danger\"\n\t\t:buttons=\"[{ text: 'Löschen', event: 'confirm', subtype: 'danger' }]\"\n\t\t@modal-result=\"removeComponent\"\n\t>\n\t\tWollen Sie die Komponente \"{{ modalComponentName }}\" wirklich entfernen?\n\t\tDieser Vorgang kann nicht rückgängig gemacht werden!\n\t</openwb-base-modal-dialog>\n\t<!-- main content -->\n\t<div class=\"hardwareInstallation\">\n\t\t<form name=\"hardwareInstallationForm\">\n\t\t\t<openwb-base-alert subtype=\"info\">\n\t\t\t\tWenn neue Komponenten - insbesondere Zähler - konfiguriert\n\t\t\t\twurden, ist auch das\n\t\t\t\t<router-link to=\"/LoadManagementConfiguration\">\n\t\t\t\t\tLastmanagement\n\t\t\t\t</router-link>\n\t\t\t\tzu prüfen!\n\t\t\t</openwb-base-alert>\n\t\t\t<openwb-base-card title=\"Systeme und Komponenten\">\n\t\t\t\t<openwb-base-select-input\n\t\t\t\t\tclass=\"mb-2\"\n\t\t\t\t\ttitle=\"Verfügbare Systeme\"\n\t\t\t\t\tnotSelected=\"Bitte auswählen\"\n\t\t\t\t\t:options=\"getDeviceList()\"\n\t\t\t\t\t:model-value=\"deviceToAdd\"\n\t\t\t\t\t@update:model-value=\"deviceToAdd = $event\"\n\t\t\t\t>\n\t\t\t\t\t<template #append>\n\t\t\t\t\t\t<span class=\"col-1\">\n\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t:class=\"\n\t\t\t\t\t\t\t\t\tdeviceToAdd === undefined\n\t\t\t\t\t\t\t\t\t\t? 'btn-outline-success'\n\t\t\t\t\t\t\t\t\t\t: 'btn-success clickable'\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t:disabled=\"deviceToAdd === undefined\"\n\t\t\t\t\t\t\t\t@click=\"addDevice\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'plus']\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #help>\n\t\t\t\t\t\tBitte ein System auswählen, das hinzugefügt werden soll.\n\t\t\t\t\t</template>\n\t\t\t\t</openwb-base-select-input>\n\t\t\t\t<openwb-base-card\n\t\t\t\t\tv-for=\"(\n\t\t\t\t\t\tinstalledDevice, installedDeviceKey\n\t\t\t\t\t) in installedDevices\"\n\t\t\t\t\t:key=\"installedDevice.id\"\n\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t\tsubtype=\"primary\"\n\t\t\t\t>\n\t\t\t\t\t<template #header>\n\t\t\t\t\t\t<openwb-base-avatar class=\"bg-success\">\n\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t:icon=\"['fas', 'network-wired']\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</openwb-base-avatar>\n\t\t\t\t\t\t{{ installedDevice.name }}\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #actions>\n\t\t\t\t\t\t<openwb-base-avatar\n\t\t\t\t\t\t\tclass=\"bg-danger clickable\"\n\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\tremoveDeviceModal(\n\t\t\t\t\t\t\t\t\tinstalledDevice.id,\n\t\t\t\t\t\t\t\t\tinstalledDevice.name,\n\t\t\t\t\t\t\t\t\t$event\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t:icon=\"['fas', 'trash']\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</openwb-base-avatar>\n\t\t\t\t\t</template>\n\t\t\t\t\t<openwb-base-text-input\n\t\t\t\t\t\ttitle=\"Bezeichnung\"\n\t\t\t\t\t\tsubtype=\"text\"\n\t\t\t\t\t\t:model-value=\"installedDevice.name\"\n\t\t\t\t\t\t@update:model-value=\"\n\t\t\t\t\t\t\tupdateState(installedDeviceKey, $event, 'name')\n\t\t\t\t\t\t\"\n\t\t\t\t\t/>\n\t\t\t\t\t<hr />\n\t\t\t\t\t<openwb-config-proxy\n\t\t\t\t\t\t:deviceId=\"installedDevice.id\"\n\t\t\t\t\t\t:deviceType=\"installedDevice.type\"\n\t\t\t\t\t\t:configuration=\"installedDevice.configuration\"\n\t\t\t\t\t\t@update:configuration=\"\n\t\t\t\t\t\t\tupdateConfiguration(installedDeviceKey, $event)\n\t\t\t\t\t\t\"\n\t\t\t\t\t/>\n\t\t\t\t\t<hr />\n\t\t\t\t\t<openwb-base-select-input\n\t\t\t\t\t\tclass=\"mb-2\"\n\t\t\t\t\t\tv-if=\"getComponentList(installedDevice.type).length\"\n\t\t\t\t\t\ttitle=\"Verfügbare Komponenten\"\n\t\t\t\t\t\tnotSelected=\"Bitte auswählen\"\n\t\t\t\t\t\t:options=\"getComponentList(installedDevice.type)\"\n\t\t\t\t\t\t:model-value=\"componentToAdd[installedDevice.id]\"\n\t\t\t\t\t\t@update:model-value=\"\n\t\t\t\t\t\t\tcomponentToAdd[installedDevice.id] = $event\n\t\t\t\t\t\t\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #append>\n\t\t\t\t\t\t\t<span class=\"col-1\">\n\t\t\t\t\t\t\t\t<openwb-base-click-button\n\t\t\t\t\t\t\t\t\t:class=\"\n\t\t\t\t\t\t\t\t\t\tcomponentToAdd[installedDevice.id] ===\n\t\t\t\t\t\t\t\t\t\tundefined\n\t\t\t\t\t\t\t\t\t\t\t? 'btn-outline-success'\n\t\t\t\t\t\t\t\t\t\t\t: 'btn-success clickable'\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t\t:disabled=\"\n\t\t\t\t\t\t\t\t\t\tcomponentToAdd[installedDevice.id] ===\n\t\t\t\t\t\t\t\t\t\tundefined\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t\taddComponent(\n\t\t\t\t\t\t\t\t\t\t\tinstalledDevice.id,\n\t\t\t\t\t\t\t\t\t\t\tinstalledDevice.type,\n\t\t\t\t\t\t\t\t\t\t\tcomponentToAdd[installedDevice.id]\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'plus']\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</openwb-base-click-button>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #help>\n\t\t\t\t\t\t\tBitte eine Komponente auswählen, die hinzugefügt\n\t\t\t\t\t\t\twerden soll.\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</openwb-base-select-input>\n\t\t\t\t\t<openwb-base-alert v-else subtype=\"info\">\n\t\t\t\t\t\tDieses System bietet keine Komponenten zur Installation\n\t\t\t\t\t\tan.\n\t\t\t\t\t</openwb-base-alert>\n\t\t\t\t\t<openwb-base-card\n\t\t\t\t\t\tv-for=\"(\n\t\t\t\t\t\t\tinstalledComponent, installedComponentKey\n\t\t\t\t\t\t) in getMyInstalledComponents(installedDevice.id)\"\n\t\t\t\t\t\t:key=\"installedComponent.id\"\n\t\t\t\t\t\t:collapsible=\"true\"\n\t\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t\t\tsubtype=\"dark\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #header>\n\t\t\t\t\t\t\t<openwb-base-avatar class=\"bg-success\">\n\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'microchip']\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</openwb-base-avatar>\n\t\t\t\t\t\t\t{{ installedComponent.name }}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #actions>\n\t\t\t\t\t\t\t<openwb-base-avatar\n\t\t\t\t\t\t\t\tclass=\"bg-danger clickable\"\n\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\tremoveComponentModal(\n\t\t\t\t\t\t\t\t\t\tinstalledDevice.id,\n\t\t\t\t\t\t\t\t\t\tinstalledComponent.id,\n\t\t\t\t\t\t\t\t\t\tinstalledComponent.type,\n\t\t\t\t\t\t\t\t\t\tinstalledComponent.name,\n\t\t\t\t\t\t\t\t\t\t$event\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<font-awesome-icon\n\t\t\t\t\t\t\t\t\tfixed-width\n\t\t\t\t\t\t\t\t\t:icon=\"['fas', 'trash']\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</openwb-base-avatar>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<openwb-base-text-input\n\t\t\t\t\t\t\ttitle=\"Bezeichnung\"\n\t\t\t\t\t\t\tsubtype=\"text\"\n\t\t\t\t\t\t\t:model-value=\"installedComponent.name\"\n\t\t\t\t\t\t\t@update:model-value=\"\n\t\t\t\t\t\t\t\tupdateState(\n\t\t\t\t\t\t\t\t\tinstalledComponentKey,\n\t\t\t\t\t\t\t\t\t$event,\n\t\t\t\t\t\t\t\t\t'name'\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t<openwb-config-proxy\n\t\t\t\t\t\t\t:deviceId=\"installedDevice.id\"\n\t\t\t\t\t\t\t:deviceType=\"installedDevice.type\"\n\t\t\t\t\t\t\t:componentId=\"installedComponent.id\"\n\t\t\t\t\t\t\t:componentType=\"installedComponent.type\"\n\t\t\t\t\t\t\t:configuration=\"installedComponent.configuration\"\n\t\t\t\t\t\t\t@update:configuration=\"\n\t\t\t\t\t\t\t\tupdateConfiguration(\n\t\t\t\t\t\t\t\t\tinstalledComponentKey,\n\t\t\t\t\t\t\t\t\t$event\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</openwb-base-card>\n\t\t\t\t</openwb-base-card>\n\t\t\t</openwb-base-card>\n\n\t\t\t<openwb-base-submit-buttons\n\t\t\t\tformName=\"hardwareInstallationForm\"\n\t\t\t\t@save=\"$emit('save')\"\n\t\t\t\t@reset=\"$emit('reset')\"\n\t\t\t\t@defaults=\"$emit('defaults')\"\n\t\t\t/>\n\t\t</form>\n\t</div>\n</template>\n\n<script>\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\nimport {\n\tfaPlus as fasPlus,\n\tfaTrash as fasTrash,\n\tfaNetworkWired as fasNetworkWired,\n\tfaMicrochip as fasMicrochip,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\n\nlibrary.add(fasPlus, fasNetworkWired, fasMicrochip, fasTrash);\n\nimport ComponentStateMixin from \"@/components/mixins/ComponentState.vue\";\n\nimport OpenwbConfigProxy from \"@/components/devices/OpenwbConfigProxy.vue\";\n\nexport default {\n\tname: \"OpenwbHardwareInstallation\",\n\tmixins: [ComponentStateMixin],\n\temits: [\"sendCommand\"],\n\tcomponents: {\n\t\tFontAwesomeIcon,\n\t\tOpenwbConfigProxy,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tmqttTopicsToSubscribe: [\n\t\t\t\t\"openWB/counter/get/hierarchy\",\n\t\t\t\t\"openWB/system/device/+/config\",\n\t\t\t\t\"openWB/system/device/+/component/+/config\",\n\t\t\t\t\"openWB/system/configurable/devices_components\",\n\t\t\t],\n\t\t\tdeviceToAdd: undefined,\n\t\t\tshowDeviceRemoveModal: false,\n\t\t\tmodalDevice: undefined,\n\t\t\tmodalDeviceName: \"\",\n\t\t\tcomponentToAdd: [],\n\t\t\tshowComponentRemoveModal: false,\n\t\t\tmodalComponent: undefined,\n\t\t\tmodalComponentName: \"\",\n\t\t};\n\t},\n\tcomputed: {\n\t\tinstalledDevices: {\n\t\t\tget() {\n\t\t\t\treturn this.getWildcardTopics(\"openWB/system/device/+/config\");\n\t\t\t},\n\t\t},\n\t\tinstalledComponents: {\n\t\t\tget() {\n\t\t\t\treturn this.getWildcardTopics(\n\t\t\t\t\t\"openWB/system/device/+/component/+/config\"\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\t},\n\tmethods: {\n\t\tgetMyInstalledComponents(deviceId) {\n\t\t\treturn this.getWildcardTopics(\n\t\t\t\t\"openWB/system/device/\" + deviceId + \"/component/+/config\"\n\t\t\t);\n\t\t},\n\t\taddDevice() {\n\t\t\tthis.$emit(\"sendCommand\", {\n\t\t\t\tcommand: \"addDevice\",\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.deviceToAdd,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tremoveDeviceModal(index, name, event) {\n\t\t\t// prevent further processing of the click event\n\t\t\tevent.stopPropagation();\n\t\t\tthis.modalDevice = index;\n\t\t\tthis.modalDeviceName = name;\n\t\t\tthis.showDeviceRemoveModal = true;\n\t\t},\n\t\tremoveDevice(event) {\n\t\t\tthis.showDeviceRemoveModal = false;\n\t\t\tif (event == \"confirm\") {\n\t\t\t\tconsole.info(\n\t\t\t\t\t\"request removal of device '\" + this.modalDevice + \"'\"\n\t\t\t\t);\n\t\t\t\tthis.$emit(\"sendCommand\", {\n\t\t\t\t\tcommand: \"removeDevice\",\n\t\t\t\t\tdata: { id: this.modalDevice },\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetDeviceList() {\n\t\t\treturn this.$store.state.mqtt[\n\t\t\t\t\"openWB/system/configurable/devices_components\"\n\t\t\t];\n\t\t},\n\t\taddComponent(deviceId, deviceType, componentType) {\n\t\t\tthis.$emit(\"sendCommand\", {\n\t\t\t\tcommand: \"addComponent\",\n\t\t\t\tdata: {\n\t\t\t\t\tdeviceId: deviceId,\n\t\t\t\t\tdeviceType: deviceType,\n\t\t\t\t\ttype: componentType,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tremoveComponentModal(\n\t\t\tdeviceId,\n\t\t\tcomponentId,\n\t\t\tcomponentType,\n\t\t\tcomponentName,\n\t\t\tevent\n\t\t) {\n\t\t\t// prevent further processing of the click event\n\t\t\tevent.stopPropagation();\n\t\t\tthis.modalComponent = {\n\t\t\t\tdeviceId: deviceId,\n\t\t\t\tid: componentId,\n\t\t\t\ttype: componentType,\n\t\t\t};\n\t\t\tthis.modalComponentName = componentName;\n\t\t\tthis.showComponentRemoveModal = true;\n\t\t},\n\t\tremoveComponent(event) {\n\t\t\tthis.showComponentRemoveModal = false;\n\t\t\tif (event == \"confirm\") {\n\t\t\t\tconsole.info(\n\t\t\t\t\t\"request removal of component '\" +\n\t\t\t\t\t\tthis.modalComponent.id +\n\t\t\t\t\t\t\"' from device '\" +\n\t\t\t\t\t\tthis.modalComponent.deviceId +\n\t\t\t\t\t\t\"' type '\" +\n\t\t\t\t\t\tthis.modalComponent.type +\n\t\t\t\t\t\t\"'\"\n\t\t\t\t);\n\t\t\t\tthis.$emit(\"sendCommand\", {\n\t\t\t\t\tcommand: \"removeComponent\",\n\t\t\t\t\tdata: this.modalComponent,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetComponentList(deviceType) {\n\t\t\tif (deviceType === undefined) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tconsole.debug(\"finding components for '\" + deviceType + \"'\");\n\t\t\tlet myDevice = this.$store.state.mqtt[\n\t\t\t\t\"openWB/system/configurable/devices_components\"\n\t\t\t].find((device) => device.value === deviceType);\n\t\t\treturn myDevice.component;\n\t\t},\n\t\tupdateConfiguration(key, event) {\n\t\t\tconsole.debug(\"updateConfiguration\", key, event);\n\t\t\tthis.updateState(key, event.value, event.object);\n\t\t},\n\t},\n};\n</script>\n\n<style scoped>\n.clickable {\n\tcursor: pointer;\n}\n</style>\n"],"names":[],"sourceRoot":""}