(self["webpackChunkopenwb_ui_settings"]=self["webpackChunkopenwb_ui_settings"]||[]).push([[8054],{805:function(e,n,o){"use strict";o.r(n),o.d(n,{default:function(){return A}});var t=o(6252),i=o(3577);const a=e=>((0,t.dD)("data-v-13f4ddee"),e=e(),(0,t.Cn)(),e),d={class:"hardwareInstallation"},s={name:"hardwareInstallationForm"},u=(0,t.Uk)(" Wenn neue Komponenten - insbesondere Zähler - konfiguriert wurden, ist auch das "),c=(0,t.Uk)(" Lastmanagement "),l=(0,t.Uk)(" zu prüfen! "),r={class:"col-1"},m=(0,t.Uk)(" Bitte ein System auswählen, das hinzugefügt werden soll. "),p=a((()=>(0,t._)("hr",null,null,-1))),v=a((()=>(0,t._)("hr",null,null,-1))),f={class:"col-1"},g=(0,t.Uk)(" Bitte eine Komponente auswählen, die hinzugefügt werden soll. "),w=(0,t.Uk)(" Dieses System bietet keine Komponenten zur Installation an. "),h=a((()=>(0,t._)("hr",null,null,-1)));function b(e,n,o,a,b,y){const C=(0,t.up)("openwb-base-modal-dialog"),k=(0,t.up)("router-link"),_=(0,t.up)("openwb-base-alert"),W=(0,t.up)("font-awesome-icon"),T=(0,t.up)("openwb-base-click-button"),D=(0,t.up)("openwb-base-select-input"),U=(0,t.up)("openwb-base-avatar"),x=(0,t.up)("openwb-base-text-input"),I=(0,t.up)("openwb-config-proxy"),z=(0,t.up)("openwb-base-card"),M=(0,t.up)("openwb-base-submit-buttons");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(C,{show:b.showDeviceRemoveModal,title:"Gerät löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:y.removeDevice},{default:(0,t.w5)((()=>[(0,t.Uk)(' Wollen Sie das Gerät "'+(0,i.zw)(b.modalDeviceName)+'" inklusive aller Komponenten wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ',1)])),_:1},8,["show","onModalResult"]),(0,t.Wm)(C,{show:b.showComponentRemoveModal,title:"Komponente löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:y.removeComponent},{default:(0,t.w5)((()=>[(0,t.Uk)(' Wollen Sie die Komponente "'+(0,i.zw)(b.modalComponentName)+'" wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ',1)])),_:1},8,["show","onModalResult"]),(0,t._)("div",d,[(0,t._)("form",s,[(0,t.Wm)(_,{subtype:"info"},{default:(0,t.w5)((()=>[u,(0,t.Wm)(k,{to:"/LoadManagementConfiguration"},{default:(0,t.w5)((()=>[c])),_:1}),l])),_:1}),(0,t.Wm)(z,{title:"Systeme und Komponenten"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{class:"mb-2",title:"Verfügbare Systeme",notSelected:"Bitte auswählen",options:y.getDeviceList(),"model-value":b.deviceToAdd,"onUpdate:modelValue":n[0]||(n[0]=e=>b.deviceToAdd=e)},{append:(0,t.w5)((()=>[(0,t._)("span",r,[(0,t.Wm)(T,{class:(0,i.C_)(void 0===b.deviceToAdd?"btn-outline-success":"btn-success clickable"),disabled:void 0===b.deviceToAdd,onClick:y.addDevice},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{"fixed-width":"",icon:["fas","plus"]})])),_:1},8,["class","disabled","onClick"])])])),help:(0,t.w5)((()=>[m])),_:1},8,["options","model-value"]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(y.installedDevices,((n,o)=>((0,t.wg)(),(0,t.j4)(z,{key:n.id,collapsible:!0,collapsed:!0,subtype:"primary"},{header:(0,t.w5)((()=>[(0,t.Wm)(U,{class:"bg-success"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{"fixed-width":"",icon:["fas","network-wired"]})])),_:1}),(0,t.Uk)(" "+(0,i.zw)(n.name),1)])),actions:(0,t.w5)((()=>[(0,t.Wm)(U,{class:"bg-danger clickable",onClick:e=>y.removeDeviceModal(n.id,n.name,e)},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{"fixed-width":"",icon:["fas","trash"]})])),_:2},1032,["onClick"])])),default:(0,t.w5)((()=>[(0,t.Wm)(x,{title:"Bezeichnung",subtype:"text","model-value":n.name,"onUpdate:modelValue":n=>e.updateState(o,n,"name")},null,8,["model-value","onUpdate:modelValue"]),p,(0,t.Wm)(I,{deviceId:n.id,deviceType:n.type,configuration:n.configuration,"onUpdate:configuration":e=>y.updateConfiguration(o,e)},null,8,["deviceId","deviceType","configuration","onUpdate:configuration"]),v,y.getComponentList(n.type).length?((0,t.wg)(),(0,t.j4)(D,{key:0,class:"mb-2",title:"Verfügbare Komponenten",notSelected:"Bitte auswählen",options:y.getComponentList(n.type),"model-value":b.componentToAdd[n.id],"onUpdate:modelValue":e=>b.componentToAdd[n.id]=e},{append:(0,t.w5)((()=>[(0,t._)("span",f,[(0,t.Wm)(T,{class:(0,i.C_)(void 0===b.componentToAdd[n.id]?"btn-outline-success":"btn-success clickable"),disabled:void 0===b.componentToAdd[n.id],onClick:e=>y.addComponent(n.id,n.type,b.componentToAdd[n.id])},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{"fixed-width":"",icon:["fas","plus"]})])),_:2},1032,["class","disabled","onClick"])])])),help:(0,t.w5)((()=>[g])),_:2},1032,["options","model-value","onUpdate:modelValue"])):((0,t.wg)(),(0,t.j4)(_,{key:1,subtype:"info"},{default:(0,t.w5)((()=>[w])),_:1})),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(y.getMyInstalledComponents(n.id),((o,a)=>((0,t.wg)(),(0,t.j4)(z,{key:o.id,collapsible:!0,collapsed:!0,subtype:"dark"},{header:(0,t.w5)((()=>[(0,t.Wm)(U,{class:"bg-success"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{"fixed-width":"",icon:["fas","microchip"]})])),_:1}),(0,t.Uk)(" "+(0,i.zw)(o.name),1)])),actions:(0,t.w5)((()=>[(0,t.Wm)(U,{class:"bg-danger clickable",onClick:e=>y.removeComponentModal(n.id,o.id,o.type,o.name,e)},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{"fixed-width":"",icon:["fas","trash"]})])),_:2},1032,["onClick"])])),default:(0,t.w5)((()=>[(0,t.Wm)(x,{title:"Bezeichnung",subtype:"text","model-value":o.name,"onUpdate:modelValue":n=>e.updateState(a,n,"name")},null,8,["model-value","onUpdate:modelValue"]),h,(0,t.Wm)(I,{deviceId:n.id,deviceType:n.type,componentId:o.id,componentType:o.type,configuration:o.configuration,"onUpdate:configuration":e=>y.updateConfiguration(a,e)},null,8,["deviceId","deviceType","componentId","componentType","configuration","onUpdate:configuration"])])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1}),(0,t.Wm)(M,{formName:"hardwareInstallationForm",onSave:n[1]||(n[1]=n=>e.$emit("save")),onReset:n[2]||(n[2]=n=>e.$emit("reset")),onDefaults:n[3]||(n[3]=n=>e.$emit("defaults"))})])])],64)}var y=o(8947),C=o(1436),k=o(7810),_=o(6061);const W={key:1},T=(0,t.Uk)(" Es wurde keine Konfigurationsseite für den "),D={key:0},U={key:1},x=(0,t.Uk)(" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. "),I=(0,t.Uk)(" Bitte prüfen Sie, ob die Eingaben richtig interpretiert werden. ");function z(e,n,o,a,d,s){const u=(0,t.up)("openwb-base-alert"),c=(0,t.up)("openwb-base-textarea");return d.componentTemplateFound?((0,t.wg)(),(0,t.j4)((0,t.LL)(s.myComponent),{key:0,configuration:o.configuration,deviceId:o.deviceId,componentId:o.componentId,"onUpdate:configuration":n[0]||(n[0]=e=>s.updateConfiguration(e))},null,8,["configuration","deviceId","componentId"])):((0,t.wg)(),(0,t.iD)("div",W,[(0,t.Wm)(u,{subtype:"warning"},{default:(0,t.w5)((()=>[T,o.componentType?((0,t.wg)(),(0,t.iD)("span",D,' Komponententyp "'+(0,i.zw)(o.componentType)+'" ',1)):((0,t.wg)(),(0,t.iD)("span",U,'Gerätetyp "'+(0,i.zw)(o.deviceType)+'"',1)),x])),_:1}),(0,t.Wm)(c,{title:"Konfiguration",subtype:"json","model-value":o.configuration,"onUpdate:modelValue":n[1]||(n[1]=e=>s.updateConfiguration({value:e,object:"configuration"}))},{help:(0,t.w5)((()=>[I])),_:1},8,["model-value"]),(0,t.Wm)(u,{subtype:"info"},{default:(0,t.w5)((()=>[(0,t._)("pre",null,(0,i.zw)(JSON.stringify(o.configuration,void 0,2)),1)])),_:1})]))}var M={name:"OpenwbConfigProxy",emits:["update:configuration"],props:{deviceId:{required:!0},deviceType:{type:String,required:!0},componentId:{default:void 0},componentType:{type:String,default:void 0},configuration:{type:Object,required:!0}},data(){return{componentTemplateFound:!0}},computed:{myComponent(){return console.debug(`loading component: ${this.deviceType} / ${this.componentType}`),(0,t.RC)((()=>o(8520)(`./${this.deviceType}${this.componentType?`/${this.componentType}`:"/device"}.vue`).then((e=>(this.componentTemplateFound=!0,e))).catch((e=>{console.warn("component template not found",e),this.componentTemplateFound=!1}))))}},methods:{updateConfiguration(e){this.$emit("update:configuration",e)}}},S=o(8118);const j=(0,S.Z)(M,[["render",z]]);var B=j;y.vI.add(C.r8p,C.kXW,C.zvy,C.$aW);var $={name:"OpenwbHardwareInstallation",mixins:[_.Z],emits:["sendCommand"],components:{FontAwesomeIcon:k.GN,OpenwbConfigProxy:B},data(){return{mqttTopicsToSubscribe:["openWB/counter/get/hierarchy","openWB/system/device/+/config","openWB/system/device/+/component/+/config","openWB/system/configurable/devices_components"],deviceToAdd:void 0,showDeviceRemoveModal:!1,modalDevice:void 0,modalDeviceName:"",componentToAdd:[],showComponentRemoveModal:!1,modalComponent:void 0,modalComponentName:""}},computed:{installedDevices:{get(){return this.getWildcardTopics("openWB/system/device/+/config")}},installedComponents:{get(){return this.getWildcardTopics("openWB/system/device/+/component/+/config")}}},methods:{getMyInstalledComponents(e){return this.getWildcardTopics("openWB/system/device/"+e+"/component/+/config")},addDevice(){this.$emit("sendCommand",{command:"addDevice",data:{type:this.deviceToAdd}})},removeDeviceModal(e,n,o){o.stopPropagation(),this.modalDevice=e,this.modalDeviceName=n,this.showDeviceRemoveModal=!0},removeDevice(e){this.showDeviceRemoveModal=!1,"confirm"==e&&(console.info("request removal of device '"+this.modalDevice+"'"),this.$emit("sendCommand",{command:"removeDevice",data:{id:this.modalDevice}}))},getDeviceList(){return this.$store.state.mqtt["openWB/system/configurable/devices_components"]},addComponent(e,n,o){this.$emit("sendCommand",{command:"addComponent",data:{deviceId:e,deviceType:n,type:o}})},removeComponentModal(e,n,o,t,i){i.stopPropagation(),this.modalComponent={deviceId:e,id:n,type:o},this.modalComponentName=t,this.showComponentRemoveModal=!0},removeComponent(e){this.showComponentRemoveModal=!1,"confirm"==e&&(console.info("request removal of component '"+this.modalComponent.id+"' from device '"+this.modalComponent.deviceId+"' type '"+this.modalComponent.type+"'"),this.$emit("sendCommand",{command:"removeComponent",data:this.modalComponent}))},getComponentList(e){if(void 0===e)return[];console.debug("finding components for '"+e+"'");let n=this.$store.state.mqtt["openWB/system/configurable/devices_components"].find((n=>n.value===e));return n.component},updateConfiguration(e,n){console.debug("updateConfiguration",n),this.updateState(e,n.value,n.object)}}};const R=(0,S.Z)($,[["render",b],["__scopeId","data-v-13f4ddee"]]);var A=R},8520:function(e,n,o){var t={"./alpha_ess/bat.vue":[6631,6631],"./alpha_ess/counter.vue":[4314,4314],"./alpha_ess/device.vue":[2132,2132],"./alpha_ess/inverter.vue":[8601,8601],"./carlo_gavazzi/counter.vue":[2463,2463],"./carlo_gavazzi/device.vue":[269,269],"./fronius/bat.vue":[9154,9154],"./fronius/counter_s0.vue":[6177,6177],"./fronius/counter_sm.vue":[1944,1944],"./fronius/device.vue":[585,585],"./fronius/inverter.vue":[8039,8039],"./http/bat.vue":[431,431],"./http/counter.vue":[6072,6072],"./http/device.vue":[8731,498],"./http/inverter.vue":[9275,9275],"./huawei/bat.vue":[8297,8297],"./huawei/counter.vue":[8175,8175],"./huawei/device.vue":[968,968],"./huawei/inverter.vue":[9517,9517],"./janitza/counter.vue":[6662,6662],"./janitza/device.vue":[7204,7204],"./json/bat.vue":[496,496],"./json/counter.vue":[6274,6274],"./json/device.vue":[9285,9285],"./json/inverter.vue":[7539,7539],"./mqtt/bat.vue":[7280,7280],"./mqtt/counter.vue":[3795,3795],"./mqtt/device.vue":[1226,6191],"./mqtt/inverter.vue":[3899,3899],"./openwb_flex/bat.vue":[7780,7780],"./openwb_flex/counter.vue":[4738,4738],"./openwb_flex/device.vue":[4821,4821],"./openwb_flex/inverter.vue":[9504,9669],"./powerdog/counter.vue":[5909,5909],"./powerdog/device.vue":[8962,8962],"./powerdog/inverter.vue":[3885,3885],"./saxpower/bat.vue":[8568,8568],"./saxpower/device.vue":[8164,8164],"./siemens/bat.vue":[275,275],"./siemens/counter.vue":[6604,6604],"./siemens/device.vue":[9410,9410],"./siemens/inverter.vue":[1258,1258],"./sma_shm/counter.vue":[4962,4962],"./sma_shm/device.vue":[9170,9170],"./sma_shm/inverter.vue":[8347,8347],"./solax/bat.vue":[2184,8212],"./solax/counter.vue":[5517,5517],"./solax/device.vue":[3997,3997],"./solax/inverter.vue":[8128,4635],"./sonnenbatterie/bat.vue":[558,558],"./sonnenbatterie/counter.vue":[3420,3420],"./sonnenbatterie/device.vue":[7746,7746],"./sonnenbatterie/inverter.vue":[366,366],"./studer/bat.vue":[3826,3826],"./studer/device.vue":[5200,5200],"./studer/inverter.vue":[6940,1128]};function i(e){if(!o.o(t,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=t[e],i=n[0];return o.e(n[1]).then((function(){return o(i)}))}i.keys=function(){return Object.keys(t)},i.id=8520,e.exports=i}}]);
//# sourceMappingURL=HardwareInstallation.c71e1073.js.map