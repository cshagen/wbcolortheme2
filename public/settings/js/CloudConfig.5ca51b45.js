"use strict";(self["webpackChunkopenwb_ui_settings"]=self["webpackChunkopenwb_ui_settings"]||[]).push([[9237],{4225:function(e,t,n){n.r(t),n.d(t,{default:function(){return W}});var o=n(6252),d=n(3577);const a={class:"support"},u={key:1},l={key:1,name:"cloudConfigCreateForm"},s={key:0},r={key:1},i={class:"row justify-content-center"},m={key:2,name:"cloudConfigConnectForm"},c={key:0},g={key:1},p={class:"row justify-content-center"},w={key:3,name:"cloudConfigured"},C=(0,o._)("span",null,[(0,o.Uk)(" Mit diesen Zugangsdaten können Sie sich in der "),(0,o._)("a",{href:"https://web.openwb.de/"},"openWB Cloud "),(0,o.Uk)(" anmelden. ")],-1),b={class:"row justify-content-center"};function k(e,t,n,k,f,B){const h=(0,o.up)("openwb-base-modal-dialog"),y=(0,o.up)("router-link"),W=(0,o.up)("openwb-base-alert"),_=(0,o.up)("openwb-base-text-input"),v=(0,o.up)("openwb-base-click-button"),D=(0,o.up)("openwb-base-card"),q=(0,o.up)("openwb-base-heading");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(h,{show:f.showCloudRemoveModal,title:"Cloud Zugang löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:t[0]||(t[0]=e=>B.removeCloud(e))},{default:(0,o.w5)((()=>[(0,o.Uk)(" Wollen Sie den vorhandenen Cloud Zugang wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ")])),_:1},8,["show"]),(0,o._)("div",a,[!0!==e.$store.state.mqtt["openWB/system/dataprotection_acknowledged"]?((0,o.wg)(),(0,o.j4)(W,{key:0,subtype:"danger"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Sie müssen der "),(0,o.Wm)(y,{to:"/System/DataProtection"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Datenschutzerklärung ")])),_:1}),(0,o.Uk)(" zustimmen, um die openWB Cloud nutzen zu können. ")])),_:1})):((0,o.wg)(),(0,o.iD)("div",u,[(0,o.Wm)(W,{subtype:"success"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Sie haben der "),(0,o.Wm)(y,{to:"/System/DataProtection"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Datenschutzerklärung ")])),_:1}),(0,o.Uk)(" zugestimmt und können die openWB Cloud nutzen. ")])),_:1}),f.enableRemoveCloudButton?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(W,{key:0,subtype:"warning"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Der Zugang wurde entfernt. Bitte starten Sie die openWB neu, um die Änderungen anzuwenden! ")])),_:1})),B.cloudBridgeKey?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("form",l,[(0,o.Wm)(D,{title:"Neuen Zugang erstellen"},(0,o.Nv)({default:(0,o.w5)((()=>[!0===e.$store.state.mqtt["openWB/general/extern"]?((0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(W,{subtype:"info"},{default:(0,o.w5)((()=>[(0,o.Uk)(' Diese openWB befindet sich im Modus "Nur Ladepunkt". Bitte richten Sie die openWB Cloud auf der regelnden openWB ein. ')])),_:1})])):((0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(_,{title:"Benutzername",required:"",subtype:"user",pattern:"[a-zA-Z]+",modelValue:f.newCloudData.username,"onUpdate:modelValue":t[1]||(t[1]=e=>f.newCloudData.username=e)},null,8,["modelValue"]),(0,o.Wm)(_,{title:"E-Mail",required:"",subtype:"email",modelValue:f.newCloudData.email,"onUpdate:modelValue":t[2]||(t[2]=e=>f.newCloudData.email=e)},null,8,["modelValue"])]))])),_:2},[!1===e.$store.state.mqtt["openWB/general/extern"]&&!0===e.$store.state.mqtt["openWB/system/dataprotection_acknowledged"]?{name:"footer",fn:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o.Wm)(v,{class:(0,d.C_)(["col-4",f.enableNewCloudButton?"btn-success":"btn-outline-success"]),disabled:!f.enableNewCloudButton,onClick:B.createCloud},{default:(0,o.w5)((()=>[(0,o.Uk)(" Zugang erstellen ")])),_:1},8,["class","disabled","onClick"])])])),key:"0"}:void 0]),1024),f.enableNewCloudButton?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(W,{key:0,subtype:"info",class:"mb-2"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Der neue Zugang wird eingerichtet. Dieser Vorgang kann bis zu einer Minute dauern. Bitte warten. ")])),_:1}))])),B.cloudBridgeKey?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("form",m,[(0,o.Wm)(D,{title:"Vorhandenen Zugang einrichten"},(0,o.Nv)({default:(0,o.w5)((()=>[!0===e.$store.state.mqtt["openWB/general/extern"]?((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(W,{subtype:"info"},{default:(0,o.w5)((()=>[(0,o.Uk)(' Diese openWB befindet sich im Modus "Nur Ladepunkt". Bitte richten Sie die openWB Cloud auf der regelnden openWB ein. ')])),_:1})])):((0,o.wg)(),(0,o.iD)("div",g,[(0,o.Wm)(_,{title:"Benutzername",required:"",subtype:"user",modelValue:f.connectCloudData.username,"onUpdate:modelValue":t[3]||(t[3]=e=>f.connectCloudData.username=e)},null,8,["modelValue"]),(0,o.Wm)(_,{title:"Passwort",required:"",subtype:"password",modelValue:f.connectCloudData.password,"onUpdate:modelValue":t[4]||(t[4]=e=>f.connectCloudData.password=e)},null,8,["modelValue"])]))])),_:2},[!1===e.$store.state.mqtt["openWB/general/extern"]&&!0===e.$store.state.mqtt["openWB/system/dataprotection_acknowledged"]?{name:"footer",fn:(0,o.w5)((()=>[(0,o._)("div",p,[(0,o.Wm)(v,{class:(0,d.C_)(["col-4",f.enableCloudConnectButton?"btn-success":"btn-outline-success"]),disabled:!f.enableCloudConnectButton,onClick:B.connectCloud},{default:(0,o.w5)((()=>[(0,o.Uk)(" Mit Cloud verbinden ")])),_:1},8,["class","disabled","onClick"])])])),key:"0"}:void 0]),1024)])),B.cloudBridgeKey?((0,o.wg)(),(0,o.iD)("form",w,[f.enableCloudConnectButton&&f.enableNewCloudButton?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(W,{key:0,subtype:"warning"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Der Zugang wurde eingerichtet. Bitte starten Sie die openWB neu, um die Änderungen anzuwenden! ")])),_:1})),(0,o.Wm)(D,{title:"Vorhandener Cloud Zugang"},{footer:(0,o.w5)((()=>[(0,o._)("div",b,[(0,o.Wm)(v,{class:(0,d.C_)(["col-4",f.enableRemoveCloudButton?"btn-danger":"btn-outline-danger"]),disabled:!f.enableRemoveCloudButton,onClick:t[7]||(t[7]=e=>B.removeCloudModal(e))},{default:(0,o.w5)((()=>[(0,o.Uk)(" Zugang löschen ")])),_:1},8,["class","disabled"])])])),default:(0,o.w5)((()=>[(0,o.Wm)(q,null,{default:(0,o.w5)((()=>[C])),_:1}),(0,o.Wm)(_,{title:"Benutzername",required:"",subtype:"user",modelValue:B.getCloudCredentials().username,"onUpdate:modelValue":t[5]||(t[5]=e=>B.getCloudCredentials().username=e),disabled:""},null,8,["modelValue"]),(0,o.Wm)(_,{title:"Passwort",required:"",subtype:"password",modelValue:B.getCloudCredentials().password,"onUpdate:modelValue":t[6]||(t[6]=e=>B.getCloudCredentials().password=e),disabled:""},null,8,["modelValue"])])),_:1})])):(0,o.kq)("",!0)]))])],64)}var f=n(7029),B={name:"OpenwbCloudConfig",mixins:[f.Z],emits:["sendCommand"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/system/dataprotection_acknowledged","openWB/system/mqtt/bridge/+"],enableNewCloudButton:!0,newCloudData:{email:"",username:""},enableCloudConnectButton:!0,connectCloudData:{username:"",password:""},enableRemoveCloudButton:!0,showCloudRemoveModal:!1}},computed:{cloudBridge:{get(){let e=this.getWildcardTopics("openWB/system/mqtt/bridge/+");for(const[t,n]of Object.entries(e))n.remote.is_openwb_cloud||delete e[t];return e}},cloudBridgeKey:{get(){for(const[e,t]of Object.entries(this.cloudBridge))if(t.remote.is_openwb_cloud)return e}}},methods:{getCloudCredentials(){return{username:this.cloudBridge[this.cloudBridgeKey].remote.username,password:this.cloudBridge[this.cloudBridgeKey].remote.password}},getMqttBridgeIndex(e){return parseInt(e.match(/(?:\/)(\d+)$/)[1])},createCloud(){document.forms.cloudConfigCreateForm.reportValidity()&&(this.$emit("sendCommand",{command:"initCloud",data:this.newCloudData}),this.enableNewCloudButton=!1)},connectCloud(){document.forms.cloudConfigConnectForm.reportValidity()&&(this.$emit("sendCommand",{command:"connectCloud",data:this.connectCloudData}),this.enableCloudConnectButton=!1)},removeCloudModal(e){e.stopPropagation(),this.showCloudRemoveModal=!0},removeCloud(e){this.showCloudRemoveModal=!1,"confirm"==e&&(console.info("request removal of cloud"),this.$emit("sendCommand",{command:"removeMqttBridge",data:{bridge:this.getMqttBridgeIndex(this.cloudBridgeKey)}}))}}},h=n(3744);const y=(0,h.Z)(B,[["render",k]]);var W=y}}]);
//# sourceMappingURL=CloudConfig.5ca51b45.js.map