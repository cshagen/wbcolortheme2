(self["webpackChunkopenwb_ui_settings"]=self["webpackChunkopenwb_ui_settings"]||[]).push([[3488],{3429:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return He}});a(7327),a(1539);var i=a(6252),n=function(e){return(0,i.dD)("data-v-54d89ed8"),e=e(),(0,i.Cn)(),e},l={class:"chargeLog"},o={name:"chargeLogForm"},r=(0,i.Uk)(" Erweiterte Optionen "),s=(0,i.Uk)(" Es können mehrere Elemente mit Strg ausgewählt werden. "),g=(0,i.Uk)(" Es können mehrere Elemente mit Strg ausgewählt werden. "),c=(0,i.Uk)(" Es können mehrere Elemente mit Strg ausgewählt werden. "),d={class:"row justify-content-center"},u=(0,i.Uk)(" Filter anwenden "),p=(0,i.Uk)(" Es wurden noch keine Daten abgerufen. "),h={key:1},m={key:0},v=n((function(){return(0,i._)("h2",null,"Summe",-1)}));function f(e,t,a,n,f,b){var _=(0,i.up)("openwb-base-text-input"),w=(0,i.up)("font-awesome-icon"),k=(0,i.up)("openwb-base-button-group-input"),y=(0,i.up)("openwb-base-select-input"),D=(0,i.up)("openwb-base-card"),L=(0,i.up)("openwb-base-click-button"),x=(0,i.up)("openwb-base-alert"),C=(0,i.up)("vue3-table-lite");return(0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("form",o,[(0,i.Wm)(D,{title:"Filter"},{footer:(0,i.w5)((function(){return[(0,i._)("div",d,[(0,i.Wm)(L,{class:"col-4 btn-success",onClick:t[5]||(t[5]=function(e){return b.requestChargeLog()})},{default:(0,i.w5)((function(){return[u]})),_:1})])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(_,{title:"Zeitraum",subtype:"month",min:"2018-01",max:f.currentMonth,modelValue:b.chargeLogDate,"onUpdate:modelValue":t[0]||(t[0]=function(e){return b.chargeLogDate=e})},null,8,["max","modelValue"]),(0,i.Wm)(D,{title:"Erweiterte Optionen",collapsible:!0,collapsed:!0},{header:(0,i.w5)((function(){return[(0,i.Wm)(w,{"fixed-width":"",icon:["fas","filter"]}),r]})),default:(0,i.w5)((function(){return[(0,i.Wm)(k,{title:"Priorität",buttons:[{buttonValue:void 0,text:"Alle"},{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],modelValue:f.chargeLogRequestData.filter.vehicle.prio,"onUpdate:modelValue":t[1]||(t[1]=function(e){return f.chargeLogRequestData.filter.vehicle.prio=e})},null,8,["modelValue"]),(0,i.Wm)(y,{title:"Lademodus",multiple:"",options:b.chargeModeList,modelValue:f.chargeLogRequestData.filter.vehicle.chargemode,"onUpdate:modelValue":t[2]||(t[2]=function(e){return f.chargeLogRequestData.filter.vehicle.chargemode=e})},{help:(0,i.w5)((function(){return[s]})),_:1},8,["options","modelValue"]),(0,i.Wm)(y,{title:"Ladepunkt",multiple:"",options:b.chargePointList,modelValue:f.chargeLogRequestData.filter.chargepoint.id,"onUpdate:modelValue":t[3]||(t[3]=function(e){return f.chargeLogRequestData.filter.chargepoint.id=e})},{help:(0,i.w5)((function(){return[g]})),_:1},8,["options","modelValue"]),(0,i.Wm)(y,{title:"Fahrzeug",multiple:"",options:b.vehicleList,modelValue:f.chargeLogRequestData.filter.vehicle.id,"onUpdate:modelValue":t[4]||(t[4]=function(e){return f.chargeLogRequestData.filter.vehicle.id=e})},{help:(0,i.w5)((function(){return[c]})),_:1},8,["options","modelValue"])]})),_:1})]})),_:1}),b.chargeLogRead?((0,i.wg)(),(0,i.iD)("div",h,[(0,i.Wm)(C,{class:"charge-log-table","is-static-mode":!0,columns:f.table.columns,rows:b.chargeLogDataset,total:b.totalRecordCount,sortable:f.table.sortable,messages:f.table.messages,"page-options":f.table.pageOptions,limit:25},null,8,["columns","rows","total","sortable","messages","page-options"]),b.totalRecordCount>0?((0,i.wg)(),(0,i.iD)("div",m,[v,(0,i.Wm)(C,{class:"charge-log-totals","is-static-mode":!0,"is-hide-paging":!0,columns:f.totals.columns,rows:b.chargeLogTotals,total:1},null,8,["columns","rows"])])):(0,i.kq)("",!0)])):((0,i.wg)(),(0,i.j4)(x,{key:0,subtype:"info"},{default:(0,i.w5)((function(){return[p]})),_:1}))])])}var b=a(8818),_=(a(4916),a(3123),a(1249),a(3948),a(8309),a(9720),a(4723),a(3112),a(8947)),w=a(1436),k=a(7810),y=a(3577),D=a(9963);const L=e=>((0,i.dD)("data-v-d8b63abc"),e=e(),(0,i.Cn)(),e),x={class:"card"},C={key:0,class:"vtl-title card-header"},S={class:"card-body"},q=L((()=>(0,i._)("p",{class:"card-title"},null,-1))),P={id:"dataTables-example_wrapper",class:"dataTables_wrapper dt-bootstrap4 no-footer"},R=L((()=>(0,i._)("div",{class:"row"},null,-1))),E={class:"row"},z={class:"col-sm-12"},M=L((()=>(0,i._)("div",{class:"row"},null,-1))),W={key:0,class:"loading-mask"},V=L((()=>(0,i._)("div",{class:"loading-content"},[(0,i._)("span",{style:{color:"white"}},"Loading...")],-1))),H=[V],A={class:"vtl-table table table-hover table-bordered table-responsive-sm",id:"dataTables-example",ref:"localTable"},O={class:"vtl-thead thead-dark"},T={class:"vtl-thead-tr"},F={key:0,class:"vtl-thead-th checkbox-th"},Y=["onClick"],B={key:0,class:"vtl-tbody"},j={key:0,class:"vtl-tbody-td"},N=["value"],I=["innerHTML"],U={key:0},K={key:1},Z={key:0,class:"vtl-tbody-td"},$=["value"],G=["innerHTML"],J={key:1},X={key:0},Q={key:1},ee={key:0,class:"vtl-paging row"},te={class:"vtl-paging-info col-sm-12 col-md-4"},ae={role:"status","aria-live":"polite"},ie={class:"vtl-paging-change-div col-sm-12 col-md-4"},ne={class:"vtl-paging-count-label"},le=["value"],oe={class:"vtl-paging-page-label"},re=["value"],se={class:"vtl-paging-pagination-div col-sm-12 col-md-4"},ge={class:"dataTables_paginate paging_simple_numbers",id:"dataTables-example_paginate"},ce={class:"vtl-paging-pagination-ul pagination"},de=L((()=>(0,i._)("span",{"aria-hidden":"true"},"«",-1))),ue=L((()=>(0,i._)("span",{class:"sr-only"},"First",-1))),pe=[de,ue],he=L((()=>(0,i._)("span",{"aria-hidden":"true"},"<",-1))),me=L((()=>(0,i._)("span",{class:"sr-only"},"Prev",-1))),ve=[he,me],fe=["onClick"],be=L((()=>(0,i._)("span",{"aria-hidden":"true"},">",-1))),_e=L((()=>(0,i._)("span",{class:"sr-only"},"Next",-1))),we=[be,_e],ke=L((()=>(0,i._)("span",{"aria-hidden":"true"},"»",-1))),ye=L((()=>(0,i._)("span",{class:"sr-only"},"Last",-1))),De=[ke,ye],Le={key:1,class:"row"},xe={class:"vtl-empty-msg col-sm-12 text-center"};function Ce(e,t,a,n,l,o){return(0,i.wg)(),(0,i.iD)("div",x,[e.title?((0,i.wg)(),(0,i.iD)("div",C,(0,y.zw)(e.title),1)):(0,i.kq)("",!0),(0,i._)("div",S,[q,(0,i._)("div",P,[R,(0,i._)("div",E,[(0,i._)("div",z,[M,e.isLoading?((0,i.wg)(),(0,i.iD)("div",W,H)):(0,i.kq)("",!0),(0,i._)("table",A,[(0,i._)("thead",O,[(0,i._)("tr",T,[e.hasCheckbox?((0,i.wg)(),(0,i.iD)("th",F,[(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"vtl-thead-checkbox","onUpdate:modelValue":t[0]||(t[0]=t=>e.setting.isCheckAll=t)},null,512),[[D.e8,e.setting.isCheckAll]])])])):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columns,((t,a)=>((0,i.wg)(),(0,i.iD)("th",{class:"vtl-thead-th",key:a,style:(0,y.j5)({width:t.width?t.width:"auto"})},[(0,i._)("div",{class:(0,y.C_)(["vtl-thead-column",{sortable:t.sortable,both:t.sortable,asc:e.setting.order===t.field&&"asc"===e.setting.sort,desc:e.setting.order===t.field&&"desc"===e.setting.sort}]),onClick:a=>!!t.sortable&&e.doSort(t.field)},(0,y.zw)(t.label),11,Y)],4)))),128))])]),e.rows.length>0?((0,i.wg)(),(0,i.iD)("tbody",B,[e.isStaticMode?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)(e.localRows,((a,n)=>((0,i.wg)(),(0,i.iD)("tr",{key:n,class:"vtl-tbody-tr"},[e.hasCheckbox?((0,i.wg)(),(0,i.iD)("td",j,[(0,i._)("div",null,[(0,i._)("input",{type:"checkbox",class:"vtl-tbody-checkbox",ref_for:!0,ref:t=>{e.rowCheckbox[n]=t},value:a[e.setting.keyColumn],onClick:t[1]||(t[1]=(...t)=>e.checked&&e.checked(...t))},null,8,N)])])):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columns,((t,n)=>((0,i.wg)(),(0,i.iD)("td",{key:n,class:"vtl-tbody-td"},[t.display?((0,i.wg)(),(0,i.iD)("div",{key:0,innerHTML:t.display(a)},null,8,I)):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[e.setting.isSlotMode&&e.slots[t.field]?((0,i.wg)(),(0,i.iD)("div",U,[(0,i.WI)(e.$slots,t.field,{value:a},void 0,!0)])):((0,i.wg)(),(0,i.iD)("span",K,(0,y.zw)(a[t.field]),1))],64))])))),128))])))),128)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(e.rows,((a,n)=>((0,i.wg)(),(0,i.iD)("tr",{key:n,class:"vtl-tbody-tr"},[e.hasCheckbox?((0,i.wg)(),(0,i.iD)("td",Z,[(0,i._)("div",null,[(0,i._)("input",{type:"checkbox",class:"vtl-tbody-checkbox",ref_for:!0,ref:t=>{e.rowCheckbox[n]=t},value:a[e.setting.keyColumn],onClick:t[2]||(t[2]=(...t)=>e.checked&&e.checked(...t))},null,8,$)])])):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columns,((t,n)=>((0,i.wg)(),(0,i.iD)("td",{key:n,class:"vtl-tbody-td"},[t.display?((0,i.wg)(),(0,i.iD)("div",{key:0,innerHTML:t.display(a)},null,8,G)):((0,i.wg)(),(0,i.iD)("div",J,[e.setting.isSlotMode&&e.slots[t.field]?((0,i.wg)(),(0,i.iD)("div",X,[(0,i.WI)(e.$slots,t.field,{value:a},void 0,!0)])):((0,i.wg)(),(0,i.iD)("span",Q,(0,y.zw)(a[t.field]),1))]))])))),128))])))),128))])):(0,i.kq)("",!0)],512)])]),e.rows.length>0?((0,i.wg)(),(0,i.iD)("div",ee,[e.setting.isHidePaging?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i._)("div",te,[(0,i._)("div",ae,(0,y.zw)(e.stringFormat(e.messages.pagingInfo,e.setting.offset,e.setting.limit,e.total)),1)]),(0,i._)("div",ie,[(0,i._)("span",ne,(0,y.zw)(e.messages.pageSizeChangeLabel),1),(0,i.wy)((0,i._)("select",{class:"vtl-paging-count-dropdown","onUpdate:modelValue":t[3]||(t[3]=t=>e.setting.pageSize=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.pageOptions,(e=>((0,i.wg)(),(0,i.iD)("option",{value:e.value,key:e.value},(0,y.zw)(e.text),9,le)))),128))],512),[[D.bM,e.setting.pageSize]]),(0,i._)("span",oe,(0,y.zw)(e.messages.gotoPageLabel),1),(0,i.wy)((0,i._)("select",{class:"vtl-paging-page-dropdown","onUpdate:modelValue":t[4]||(t[4]=t=>e.setting.page=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.setting.maxPage,(e=>((0,i.wg)(),(0,i.iD)("option",{key:e,value:parseInt(e)},(0,y.zw)(e),9,re)))),128))],512),[[D.bM,e.setting.page]])]),(0,i._)("div",se,[(0,i._)("div",ge,[(0,i._)("ul",ce,[(0,i._)("li",{class:(0,y.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-first page-item",{disabled:e.setting.page<=1}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-first page-link",href:"javascript:void(0)","aria-label":"Previous",onClick:t[5]||(t[5]=t=>e.setting.page=1)},pe)],2),(0,i._)("li",{class:(0,y.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-prev page-item",{disabled:e.setting.page<=1}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-prev page-link",href:"javascript:void(0)","aria-label":"Previous",onClick:t[6]||(t[6]=(...t)=>e.prevPage&&e.prevPage(...t))},ve)],2),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.setting.paging,(t=>((0,i.wg)(),(0,i.iD)("li",{class:(0,y.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-number page-item",{disabled:e.setting.page===t}]),key:t},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-number page-link",href:"javascript:void(0)",onClick:a=>e.movePage(t)},(0,y.zw)(t),9,fe)],2)))),128)),(0,i._)("li",{class:(0,y.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-next page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-next page-link",href:"javascript:void(0)","aria-label":"Next",onClick:t[7]||(t[7]=(...t)=>e.nextPage&&e.nextPage(...t))},we)],2),(0,i._)("li",{class:(0,y.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-last page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-last page-link",href:"javascript:void(0)","aria-label":"Next",onClick:t[8]||(t[8]=t=>e.setting.page=e.setting.maxPage)},De)],2)])])])],64))])):((0,i.wg)(),(0,i.iD)("div",Le,[(0,i._)("div",xe,(0,y.zw)(e.messages.noDataAvailable),1)]))])])])}var Se=a(2262),qe=(0,i.aZ)({name:"my-table",emits:["return-checked-rows","do-search","is-finished","get-now-page"],props:{isLoading:{type:Boolean,require:!0},isReSearch:{type:Boolean,require:!0},hasCheckbox:{type:Boolean,default:!1},title:{type:String,default:""},columns:{type:Array,default:()=>[]},rows:{type:Array,default:()=>[]},pageSize:{type:Number,default:10},total:{type:Number,default:100},page:{type:Number,default:1},sortable:{type:Object,default:()=>({order:"id",sort:"asc"})},messages:{type:Object,default:()=>({pagingInfo:"Showing {0}-{1} of {2}",pageSizeChangeLabel:"Row count:",gotoPageLabel:"Go to page:",noDataAvailable:"No data"})},isStaticMode:{type:Boolean,default:!1},isSlotMode:{type:Boolean,default:!1},isHidePaging:{type:Boolean,default:!1},pageOptions:{type:Array,default:()=>[{value:10,text:10},{value:25,text:25},{value:50,text:50}]}},setup(e,{emit:t,slots:a}){let n=(0,Se.iH)(null),l=e.pageOptions.length>0?(0,Se.iH)(e.pageOptions[0].value):(0,Se.iH)(e.pageSize);e.pageOptions.length>0&&e.pageOptions.forEach((t=>{Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"text")&&e.pageSize==t.value&&(l.value=t.value)}));const o=(0,Se.qj)({isSlotMode:e.isSlotMode,isCheckAll:!1,isHidePaging:e.isHidePaging,keyColumn:(0,i.Fl)((()=>{let t="";return Object.assign(e.columns).forEach((e=>{e.isKey&&(t=e.field)})),t})),page:e.page,pageSize:l.value,maxPage:(0,i.Fl)((()=>{if(e.total<=0)return 0;let t=Math.floor(e.total/o.pageSize),a=e.total%o.pageSize;return a>0&&t++,t})),offset:(0,i.Fl)((()=>(o.page-1)*o.pageSize+1)),limit:(0,i.Fl)((()=>{let t=o.page*o.pageSize;return e.total>=t?t:e.total})),paging:(0,i.Fl)((()=>{let e=o.page-2<=0?1:o.page-2;o.maxPage-o.page<=2&&(e=o.maxPage-4),e=e<=0?1:e;let t=[];for(let a=e;a<=o.maxPage;a++)t.length<5&&t.push(a);return t})),order:e.sortable.order,sort:e.sortable.sort,pageOptions:e.pageOptions}),r=(0,i.Fl)((()=>{let t=o.order,a=1;"desc"===o.sort&&(a=-1);let n=e.rows;n.sort(((e,i)=>e[t]<i[t]?-1*a:e[t]>i[t]?a:0));let l=[];for(let e=o.offset-1;e<o.limit;e++)n[e]&&l.push(n[e]);return(0,i.Y3)((function(){b()})),l})),s=(0,Se.iH)([]);e.hasCheckbox&&((0,i.Xn)((()=>{s.value=[]})),(0,i.YP)((()=>o.isCheckAll),(e=>{let a=[];s.value.forEach((t=>{t&&(t.checked=e,t.checked&&a.push(t.value))})),t("return-checked-rows",a)})));const g=()=>{let e=[];s.value.forEach((t=>{t&&t.checked&&e.push(t.value)})),t("return-checked-rows",e)},c=()=>{s.value.forEach((e=>{e&&e.checked&&(e.checked=!1)})),t("return-checked-rows",[])},d=a=>{let i="asc";a==o.order&&"asc"==o.sort&&(i="desc");let n=(o.page-1)*o.pageSize,l=o.pageSize;o.order=a,o.sort=i,t("do-search",n,l,a,i),o.isCheckAll?o.isCheckAll=!1:e.hasCheckbox&&c()},u=(a,i)=>{o.isCheckAll=!1;let n=o.order,l=o.sort,r=(a-1)*o.pageSize,s=o.pageSize;(!e.isReSearch||a>1||a==i)&&t("do-search",r,s,n,l)};(0,i.YP)((()=>o.page),u),(0,i.YP)((()=>e.page),(e=>{e<=1?(o.page=1,t("get-now-page",o.page)):e>=o.maxPage?(o.page=o.maxPage,t("get-now-page",o.page)):o.page=e}));const p=()=>{1===o.page?u(o.page,o.page):(o.page=1,o.isCheckAll=!1)};(0,i.YP)((()=>o.pageSize),p);const h=()=>{if(1==o.page)return!1;o.page--},m=e=>{o.page=e},v=()=>{if(o.page>=o.maxPage)return!1;o.page++};(0,i.YP)((()=>e.rows),(()=>{(e.isReSearch||e.isStaticMode)&&(o.page=1),(0,i.Y3)((function(){e.isStaticMode||b()}))}));const f=(e,...t)=>e.replace(/{(\d+)}/g,(function(e,a){return"undefined"!=typeof t[a]?t[a]:e})),b=()=>{if(n.value){let e=n.value.getElementsByClassName("is-rows-el");t("is-finished",e)}t("get-now-page",o.page)};return(0,i.bv)((()=>{(0,i.Y3)((()=>{e.rows.length>0&&b()}))})),e.hasCheckbox?{slots:a,localTable:n,localRows:r,setting:o,rowCheckbox:s,checked:g,doSort:d,prevPage:h,movePage:m,nextPage:v,stringFormat:f}:{slots:a,localTable:n,localRows:r,setting:o,doSort:d,prevPage:h,movePage:m,nextPage:v,stringFormat:f}}}),Pe=a(8118);const Re=(0,Pe.Z)(qe,[["render",Ce],["__scopeId","data-v-d8b63abc"]]);var Ee=Re,ze=Ee,Me=a(4912);_.vI.add(w.G_j);var We={name:"OpenwbChargeLog",components:{Vue3TableLite:ze,FontAwesomeIcon:k.GN},mixins:[Me.Z],emits:["sendCommand"],data:function(){var e=this;return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/chargepoint/+/config","openWB/vehicle/+/name"],currentMonth:"",chargeLogRequestData:{month:"",year:"",filter:{chargepoint:{id:[]},vehicle:{id:[],chargemode:[],prio:void 0}}},table:{messages:{pagingInfo:"Einträge {0}-{1} von {2}",pageSizeChangeLabel:"Einträge:",gotoPageLabel:" Gehe zu:",noDataAvailable:"Keine Einträge gefunden."},pageOptions:[{value:5,text:"5"},{value:10,text:"10"},{value:25,text:"25"},{value:50,text:"50"},{value:100,text:"100"}],columns:[{label:"Beginn",field:"time_begin",sortable:!0},{label:"Ende",field:"time_end",sortable:!0},{label:"Fahrzeug",field:"vehicle_name",sortable:!0},{label:"Dauer",field:"time_time_charged",sortable:!0,display:function(t){return e.alignEnd(t.time_time_charged)}},{label:"Energie",field:"data_charged_since_plugged_counter",sortable:!0,display:function(t){return e.alignEnd(e.formatNumber(t.data_charged_since_plugged_counter/1e3,2)+"&nbsp;kWh / "+e.formatNumber(t.data_range_charged/1e3,0)+"&nbspkm")}},{label:"Kosten",field:"data_costs",sortable:!0,display:function(t){return e.alignEnd(e.formatNumber(t.data_costs/1e3,2)+"&nbsp;€")}},{label:"Lademodus",field:"vehicle_chargemode",sortable:!0,display:function(t){return'<div class="td-center tag '+e.getChargeModeClass(t.vehicle_chargemode)+'">'+t.vehicle_chargemode+"</div>"}},{label:"Ladepunkt",field:"chargepoint_name",sortable:!0},{label:"Priorität",field:"vehicle_prio",display:function(t){return e.translateBool(t.vehicle_prio)}}],sortable:{order:"time_begin",sort:"asc"}},totals:{columns:[{label:"Dauer",field:"time_charged",sortable:!1,display:function(t){return e.alignEnd(t.time_charged)}},{label:"Energie",field:"charged_since_plugged_counter",sortable:!1,display:function(t){return e.alignEnd(e.formatNumber(t.charged_since_plugged_counter/1e3,2)+"&nbsp;kWh")}},{label:"Reichweite",field:"range_charged",sortable:!1,display:function(t){return e.alignEnd(e.formatNumber(t.range_charged/1e3,0)+"&nbspkm")}},{label:"Kosten",field:"costs",sortable:!1,display:function(t){return e.alignEnd(e.formatNumber(t.costs/1e3,2)+"&nbsp;€")}}]}}},computed:{chargeLogDate:{get:function(){return this.chargeLogRequestData.year+"-"+this.chargeLogRequestData.month},set:function(e){var t=e.split("-");this.chargeLogRequestData.year=t[0],this.chargeLogRequestData.month=t[1]}},chargeLogTotals:function(){return this.$store.state.mqtt["openWB/log/"+this.mqttClientId+"/data"]?[this.$store.state.mqtt["openWB/log/"+this.mqttClientId+"/data"]["totals"]]:[]},chargeLogDataset:{get:function(){var e=this,t=new Intl.DateTimeFormat("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});try{return this.$store.state.mqtt["openWB/log/"+this.mqttClientId+"/data"]["entries"].map((function(a){return{chargepoint_id:a["chargepoint"]["id"],chargepoint_name:a["chargepoint"]["name"],vehicle_id:a["vehicle"]["id"],vehicle_name:a["vehicle"]["name"],vehicle_chargemode:e.translateChargeMode(a["vehicle"]["chargemode"]),vehicle_rfid:a["vehicle"]["rfid"],vehicle_prio:a["vehicle"]["prio"],time_begin:t.format(new Date(a["time"]["begin"])),time_end:t.format(new Date(a["time"]["end"])),time_time_charged:a["time"]["time_charged"],data_power:a["data"]["power"],data_range_charged:a["data"]["range_charged"],data_costs:a["data"]["costs"],data_charged_since_plugged_counter:a["data"]["charged_since_plugged_counter"],data_charged_since_mode_switch:a["data"]["charged_since_mode_switch"]}}))}catch(a){return[]}}},chargeLogRead:{get:function(){return void 0!=this.chargeLogDataset}},chargeLogHasEntries:{get:function(){return void 0!=this.chargeLogDataset&&this.chargeLogDataset.length>0}},totalRecordCount:function(){return this.chargeLogDataset.length},chargeModeList:function(){var e=this,t=this.chargeModes.map((function(t){return{value:t,text:e.translateChargeMode(t)}}));return t.unshift({value:void 0,text:"Alle"}),t},chargePointList:function(){for(var e=this.getWildcardTopics("openWB/chargepoint/+/config"),t=[{value:void 0,text:"Alle"}],a=0,i=Object.entries(e);a<i.length;a++){var n=(0,b.Z)(i[a],2),l=n[1];t.push({value:l.id,text:l.name})}return t},vehicleList:function(){for(var e=this.getWildcardTopics("openWB/vehicle/+/name"),t=[{value:void 0,text:"Alle"}],a=0,i=Object.entries(e);a<i.length;a++){var n=(0,b.Z)(i[a],2),l=n[0],o=n[1],r=parseInt(l.match(/\/([0-9]+)\/name$/)[1]);t.push({value:r,text:o})}return t}},methods:{cleanRequestData:function(){"id"in this.chargeLogRequestData.filter.chargepoint&&(this.chargeLogRequestData.filter.chargepoint.id=this.chargeLogRequestData.filter.chargepoint.id.filter((function(e){return void 0!=e}))),"chargemode"in this.chargeLogRequestData.filter.vehicle&&(this.chargeLogRequestData.filter.vehicle.chargemode=this.chargeLogRequestData.filter.vehicle.chargemode.filter((function(e){return void 0!=e}))),"id"in this.chargeLogRequestData.filter.vehicle&&(this.chargeLogRequestData.filter.vehicle.id=this.chargeLogRequestData.filter.vehicle.id.filter((function(e){return void 0!=e})))},requestChargeLog:function(){var e=document.forms["chargeLogForm"];e.reportValidity()?(this.cleanRequestData(),this.$emit("sendCommand",{command:"getChargeLog",data:this.chargeLogRequestData})):console.log("form invalid")},alignEnd:function(e){return'<div class="td-end">'+e+"</div>"},alignCenter:function(e){return'<div class="td-center">'+e+"</div>"},translateBool:function(e){var t="Nein",a="bg-danger";return e&&(t="Ja",a="bg-success"),'<div class="td-center tag '+a+'">'+t+"</div>"},getChargeModeClass:function(e){switch(e){case"Sofort":return"bg-danger";case"PV":return"bg-success";case"Zielladen":return"bg-primary";case"Standby":return"bg-secondary";case"Stop":return"bg-dark";default:return console.warn("unknown charge mode:",e),"bg-light"}},translateHeading:function(e){switch(e){case"time_charged":return"Dauer";case"range_charged":return"Reichweite";case"charged_since_mode_switch":return"Energie im Lademodus";case"charged_since_plugged_counter":return"Energie seit Anstecken";case"power":return"Leistung";case"costs":return"Kosten";default:return console.warn("unknown heading:",e),e}}},mounted:function(){var e=new Date;this.currentMonth=this.chargeLogDate=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0"),this.requestChargeLog()}};const Ve=(0,Pe.Z)(We,[["render",f],["__scopeId","data-v-54d89ed8"]]);var He=Ve},4986:function(e,t,a){var i=a(8113);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(i)},6650:function(e,t,a){var i=a(1702),n=a(7466),l=a(1340),o=a(8415),r=a(4488),s=i(o),g=i("".slice),c=Math.ceil,d=function(e){return function(t,a,i){var o,d,u=l(r(t)),p=n(a),h=u.length,m=void 0===i?" ":l(i);return p<=h||""==m?u:(o=p-h,d=s(m,c(o/m.length)),d.length>o&&(d=g(d,0,o)),e?u+d:d+u)}};e.exports={start:d(!1),end:d(!0)}},8415:function(e,t,a){"use strict";var i=a(7854),n=a(9303),l=a(1340),o=a(4488),r=i.RangeError;e.exports=function(e){var t=l(o(this)),a="",i=n(e);if(i<0||i==1/0)throw r("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(a+=t);return a}},1249:function(e,t,a){"use strict";var i=a(2109),n=a(2092).map,l=a(1194),o=l("map");i({target:"Array",proto:!0,forced:!o},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},3112:function(e,t,a){"use strict";var i=a(2109),n=a(6650).start,l=a(4986);i({target:"String",proto:!0,forced:l},{padStart:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=ChargeLog-legacy.6e1e100d.js.map