"use strict";(self["webpackChunkopenwb_ui_settings"]=self["webpackChunkopenwb_ui_settings"]||[]).push([[3488],{3429:function(e,t,a){a.r(t),a.d(t,{default:function(){return He}});var i=a(6252);const l=e=>((0,i.dD)("data-v-54d89ed8"),e=e(),(0,i.Cn)(),e),s={class:"chargeLog"},o={name:"chargeLogForm"},n=(0,i.Uk)(" Erweiterte Optionen "),g=(0,i.Uk)(" Es können mehrere Elemente mit Strg ausgewählt werden. "),r=(0,i.Uk)(" Es können mehrere Elemente mit Strg ausgewählt werden. "),c=(0,i.Uk)(" Es können mehrere Elemente mit Strg ausgewählt werden. "),d={class:"row justify-content-center"},p=(0,i.Uk)(" Filter anwenden "),h=(0,i.Uk)(" Es wurden noch keine Daten abgerufen. "),u={key:1},m={key:0},v=l((()=>(0,i._)("h2",null,"Summe",-1)));function b(e,t,a,l,b,_){const w=(0,i.up)("openwb-base-text-input"),f=(0,i.up)("font-awesome-icon"),k=(0,i.up)("openwb-base-button-group-input"),y=(0,i.up)("openwb-base-select-input"),D=(0,i.up)("openwb-base-card"),L=(0,i.up)("openwb-base-click-button"),x=(0,i.up)("openwb-base-alert"),C=(0,i.up)("vue3-table-lite");return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("form",o,[(0,i.Wm)(D,{title:"Filter"},{footer:(0,i.w5)((()=>[(0,i._)("div",d,[(0,i.Wm)(L,{class:"col-4 btn-success",onClick:t[5]||(t[5]=e=>_.requestChargeLog())},{default:(0,i.w5)((()=>[p])),_:1})])])),default:(0,i.w5)((()=>[(0,i.Wm)(w,{title:"Zeitraum",subtype:"month",min:"2018-01",max:b.currentMonth,modelValue:_.chargeLogDate,"onUpdate:modelValue":t[0]||(t[0]=e=>_.chargeLogDate=e)},null,8,["max","modelValue"]),(0,i.Wm)(D,{title:"Erweiterte Optionen",collapsible:!0,collapsed:!0},{header:(0,i.w5)((()=>[(0,i.Wm)(f,{"fixed-width":"",icon:["fas","filter"]}),n])),default:(0,i.w5)((()=>[(0,i.Wm)(k,{title:"Priorität",buttons:[{buttonValue:void 0,text:"Alle"},{buttonValue:!1,text:"Aus",class:"btn-outline-danger"},{buttonValue:!0,text:"An",class:"btn-outline-success"}],modelValue:b.chargeLogRequestData.filter.vehicle.prio,"onUpdate:modelValue":t[1]||(t[1]=e=>b.chargeLogRequestData.filter.vehicle.prio=e)},null,8,["modelValue"]),(0,i.Wm)(y,{title:"Lademodus",multiple:"",options:_.chargeModeList,modelValue:b.chargeLogRequestData.filter.vehicle.chargemode,"onUpdate:modelValue":t[2]||(t[2]=e=>b.chargeLogRequestData.filter.vehicle.chargemode=e)},{help:(0,i.w5)((()=>[g])),_:1},8,["options","modelValue"]),(0,i.Wm)(y,{title:"Ladepunkt",multiple:"",options:_.chargePointList,modelValue:b.chargeLogRequestData.filter.chargepoint.id,"onUpdate:modelValue":t[3]||(t[3]=e=>b.chargeLogRequestData.filter.chargepoint.id=e)},{help:(0,i.w5)((()=>[r])),_:1},8,["options","modelValue"]),(0,i.Wm)(y,{title:"Fahrzeug",multiple:"",options:_.vehicleList,modelValue:b.chargeLogRequestData.filter.vehicle.id,"onUpdate:modelValue":t[4]||(t[4]=e=>b.chargeLogRequestData.filter.vehicle.id=e)},{help:(0,i.w5)((()=>[c])),_:1},8,["options","modelValue"])])),_:1})])),_:1}),_.chargeLogRead?((0,i.wg)(),(0,i.iD)("div",u,[(0,i.Wm)(C,{class:"charge-log-table","is-static-mode":!0,columns:b.table.columns,rows:_.chargeLogDataset,total:_.totalRecordCount,sortable:b.table.sortable,messages:b.table.messages,"page-options":b.table.pageOptions,limit:25},null,8,["columns","rows","total","sortable","messages","page-options"]),_.totalRecordCount>0?((0,i.wg)(),(0,i.iD)("div",m,[v,(0,i.Wm)(C,{class:"charge-log-totals","is-static-mode":!0,"is-hide-paging":!0,columns:b.totals.columns,rows:_.chargeLogTotals,total:1},null,8,["columns","rows"])])):(0,i.kq)("",!0)])):((0,i.wg)(),(0,i.j4)(x,{key:0,subtype:"info"},{default:(0,i.w5)((()=>[h])),_:1}))])])}var _=a(8947),w=a(1436),f=a(7810),k=a(3577),y=a(9963);const D=e=>((0,i.dD)("data-v-d8b63abc"),e=e(),(0,i.Cn)(),e),L={class:"card"},x={key:0,class:"vtl-title card-header"},C={class:"card-body"},q=D((()=>(0,i._)("p",{class:"card-title"},null,-1))),S={id:"dataTables-example_wrapper",class:"dataTables_wrapper dt-bootstrap4 no-footer"},P=D((()=>(0,i._)("div",{class:"row"},null,-1))),R={class:"row"},E={class:"col-sm-12"},z=D((()=>(0,i._)("div",{class:"row"},null,-1))),M={key:0,class:"loading-mask"},W=D((()=>(0,i._)("div",{class:"loading-content"},[(0,i._)("span",{style:{color:"white"}},"Loading...")],-1))),H=[W],V={class:"vtl-table table table-hover table-bordered table-responsive-sm",id:"dataTables-example",ref:"localTable"},A={class:"vtl-thead thead-dark"},O={class:"vtl-thead-tr"},T={key:0,class:"vtl-thead-th checkbox-th"},F=["onClick"],Y={key:0,class:"vtl-tbody"},B={key:0,class:"vtl-tbody-td"},j=["value"],N=["innerHTML"],I={key:0},U={key:1},K={key:0,class:"vtl-tbody-td"},$=["value"],Z=["innerHTML"],G={key:1},J={key:0},X={key:1},Q={key:0,class:"vtl-paging row"},ee={class:"vtl-paging-info col-sm-12 col-md-4"},te={role:"status","aria-live":"polite"},ae={class:"vtl-paging-change-div col-sm-12 col-md-4"},ie={class:"vtl-paging-count-label"},le=["value"],se={class:"vtl-paging-page-label"},oe=["value"],ne={class:"vtl-paging-pagination-div col-sm-12 col-md-4"},ge={class:"dataTables_paginate paging_simple_numbers",id:"dataTables-example_paginate"},re={class:"vtl-paging-pagination-ul pagination"},ce=D((()=>(0,i._)("span",{"aria-hidden":"true"},"«",-1))),de=D((()=>(0,i._)("span",{class:"sr-only"},"First",-1))),pe=[ce,de],he=D((()=>(0,i._)("span",{"aria-hidden":"true"},"<",-1))),ue=D((()=>(0,i._)("span",{class:"sr-only"},"Prev",-1))),me=[he,ue],ve=["onClick"],be=D((()=>(0,i._)("span",{"aria-hidden":"true"},">",-1))),_e=D((()=>(0,i._)("span",{class:"sr-only"},"Next",-1))),we=[be,_e],fe=D((()=>(0,i._)("span",{"aria-hidden":"true"},"»",-1))),ke=D((()=>(0,i._)("span",{class:"sr-only"},"Last",-1))),ye=[fe,ke],De={key:1,class:"row"},Le={class:"vtl-empty-msg col-sm-12 text-center"};function xe(e,t,a,l,s,o){return(0,i.wg)(),(0,i.iD)("div",L,[e.title?((0,i.wg)(),(0,i.iD)("div",x,(0,k.zw)(e.title),1)):(0,i.kq)("",!0),(0,i._)("div",C,[q,(0,i._)("div",S,[P,(0,i._)("div",R,[(0,i._)("div",E,[z,e.isLoading?((0,i.wg)(),(0,i.iD)("div",M,H)):(0,i.kq)("",!0),(0,i._)("table",V,[(0,i._)("thead",A,[(0,i._)("tr",O,[e.hasCheckbox?((0,i.wg)(),(0,i.iD)("th",T,[(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"vtl-thead-checkbox","onUpdate:modelValue":t[0]||(t[0]=t=>e.setting.isCheckAll=t)},null,512),[[y.e8,e.setting.isCheckAll]])])])):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columns,((t,a)=>((0,i.wg)(),(0,i.iD)("th",{class:"vtl-thead-th",key:a,style:(0,k.j5)({width:t.width?t.width:"auto"})},[(0,i._)("div",{class:(0,k.C_)(["vtl-thead-column",{sortable:t.sortable,both:t.sortable,asc:e.setting.order===t.field&&"asc"===e.setting.sort,desc:e.setting.order===t.field&&"desc"===e.setting.sort}]),onClick:a=>!!t.sortable&&e.doSort(t.field)},(0,k.zw)(t.label),11,F)],4)))),128))])]),e.rows.length>0?((0,i.wg)(),(0,i.iD)("tbody",Y,[e.isStaticMode?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)(e.localRows,((a,l)=>((0,i.wg)(),(0,i.iD)("tr",{key:l,class:"vtl-tbody-tr"},[e.hasCheckbox?((0,i.wg)(),(0,i.iD)("td",B,[(0,i._)("div",null,[(0,i._)("input",{type:"checkbox",class:"vtl-tbody-checkbox",ref_for:!0,ref:t=>{e.rowCheckbox[l]=t},value:a[e.setting.keyColumn],onClick:t[1]||(t[1]=(...t)=>e.checked&&e.checked(...t))},null,8,j)])])):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columns,((t,l)=>((0,i.wg)(),(0,i.iD)("td",{key:l,class:"vtl-tbody-td"},[t.display?((0,i.wg)(),(0,i.iD)("div",{key:0,innerHTML:t.display(a)},null,8,N)):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[e.setting.isSlotMode&&e.slots[t.field]?((0,i.wg)(),(0,i.iD)("div",I,[(0,i.WI)(e.$slots,t.field,{value:a},void 0,!0)])):((0,i.wg)(),(0,i.iD)("span",U,(0,k.zw)(a[t.field]),1))],64))])))),128))])))),128)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(e.rows,((a,l)=>((0,i.wg)(),(0,i.iD)("tr",{key:l,class:"vtl-tbody-tr"},[e.hasCheckbox?((0,i.wg)(),(0,i.iD)("td",K,[(0,i._)("div",null,[(0,i._)("input",{type:"checkbox",class:"vtl-tbody-checkbox",ref_for:!0,ref:t=>{e.rowCheckbox[l]=t},value:a[e.setting.keyColumn],onClick:t[2]||(t[2]=(...t)=>e.checked&&e.checked(...t))},null,8,$)])])):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columns,((t,l)=>((0,i.wg)(),(0,i.iD)("td",{key:l,class:"vtl-tbody-td"},[t.display?((0,i.wg)(),(0,i.iD)("div",{key:0,innerHTML:t.display(a)},null,8,Z)):((0,i.wg)(),(0,i.iD)("div",G,[e.setting.isSlotMode&&e.slots[t.field]?((0,i.wg)(),(0,i.iD)("div",J,[(0,i.WI)(e.$slots,t.field,{value:a},void 0,!0)])):((0,i.wg)(),(0,i.iD)("span",X,(0,k.zw)(a[t.field]),1))]))])))),128))])))),128))])):(0,i.kq)("",!0)],512)])]),e.rows.length>0?((0,i.wg)(),(0,i.iD)("div",Q,[e.setting.isHidePaging?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i._)("div",ee,[(0,i._)("div",te,(0,k.zw)(e.stringFormat(e.messages.pagingInfo,e.setting.offset,e.setting.limit,e.total)),1)]),(0,i._)("div",ae,[(0,i._)("span",ie,(0,k.zw)(e.messages.pageSizeChangeLabel),1),(0,i.wy)((0,i._)("select",{class:"vtl-paging-count-dropdown","onUpdate:modelValue":t[3]||(t[3]=t=>e.setting.pageSize=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.pageOptions,(e=>((0,i.wg)(),(0,i.iD)("option",{value:e.value,key:e.value},(0,k.zw)(e.text),9,le)))),128))],512),[[y.bM,e.setting.pageSize]]),(0,i._)("span",se,(0,k.zw)(e.messages.gotoPageLabel),1),(0,i.wy)((0,i._)("select",{class:"vtl-paging-page-dropdown","onUpdate:modelValue":t[4]||(t[4]=t=>e.setting.page=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.setting.maxPage,(e=>((0,i.wg)(),(0,i.iD)("option",{key:e,value:parseInt(e)},(0,k.zw)(e),9,oe)))),128))],512),[[y.bM,e.setting.page]])]),(0,i._)("div",ne,[(0,i._)("div",ge,[(0,i._)("ul",re,[(0,i._)("li",{class:(0,k.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-first page-item",{disabled:e.setting.page<=1}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-first page-link",href:"javascript:void(0)","aria-label":"Previous",onClick:t[5]||(t[5]=t=>e.setting.page=1)},pe)],2),(0,i._)("li",{class:(0,k.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-prev page-item",{disabled:e.setting.page<=1}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-prev page-link",href:"javascript:void(0)","aria-label":"Previous",onClick:t[6]||(t[6]=(...t)=>e.prevPage&&e.prevPage(...t))},me)],2),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.setting.paging,(t=>((0,i.wg)(),(0,i.iD)("li",{class:(0,k.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-number page-item",{disabled:e.setting.page===t}]),key:t},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-number page-link",href:"javascript:void(0)",onClick:a=>e.movePage(t)},(0,k.zw)(t),9,ve)],2)))),128)),(0,i._)("li",{class:(0,k.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-next page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-next page-link",href:"javascript:void(0)","aria-label":"Next",onClick:t[7]||(t[7]=(...t)=>e.nextPage&&e.nextPage(...t))},we)],2),(0,i._)("li",{class:(0,k.C_)(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-last page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[(0,i._)("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-last page-link",href:"javascript:void(0)","aria-label":"Next",onClick:t[8]||(t[8]=t=>e.setting.page=e.setting.maxPage)},ye)],2)])])])],64))])):((0,i.wg)(),(0,i.iD)("div",De,[(0,i._)("div",Le,(0,k.zw)(e.messages.noDataAvailable),1)]))])])])}var Ce=a(2262),qe=(0,i.aZ)({name:"my-table",emits:["return-checked-rows","do-search","is-finished","get-now-page"],props:{isLoading:{type:Boolean,require:!0},isReSearch:{type:Boolean,require:!0},hasCheckbox:{type:Boolean,default:!1},title:{type:String,default:""},columns:{type:Array,default:()=>[]},rows:{type:Array,default:()=>[]},pageSize:{type:Number,default:10},total:{type:Number,default:100},page:{type:Number,default:1},sortable:{type:Object,default:()=>({order:"id",sort:"asc"})},messages:{type:Object,default:()=>({pagingInfo:"Showing {0}-{1} of {2}",pageSizeChangeLabel:"Row count:",gotoPageLabel:"Go to page:",noDataAvailable:"No data"})},isStaticMode:{type:Boolean,default:!1},isSlotMode:{type:Boolean,default:!1},isHidePaging:{type:Boolean,default:!1},pageOptions:{type:Array,default:()=>[{value:10,text:10},{value:25,text:25},{value:50,text:50}]}},setup(e,{emit:t,slots:a}){let l=(0,Ce.iH)(null),s=e.pageOptions.length>0?(0,Ce.iH)(e.pageOptions[0].value):(0,Ce.iH)(e.pageSize);e.pageOptions.length>0&&e.pageOptions.forEach((t=>{Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"text")&&e.pageSize==t.value&&(s.value=t.value)}));const o=(0,Ce.qj)({isSlotMode:e.isSlotMode,isCheckAll:!1,isHidePaging:e.isHidePaging,keyColumn:(0,i.Fl)((()=>{let t="";return Object.assign(e.columns).forEach((e=>{e.isKey&&(t=e.field)})),t})),page:e.page,pageSize:s.value,maxPage:(0,i.Fl)((()=>{if(e.total<=0)return 0;let t=Math.floor(e.total/o.pageSize),a=e.total%o.pageSize;return a>0&&t++,t})),offset:(0,i.Fl)((()=>(o.page-1)*o.pageSize+1)),limit:(0,i.Fl)((()=>{let t=o.page*o.pageSize;return e.total>=t?t:e.total})),paging:(0,i.Fl)((()=>{let e=o.page-2<=0?1:o.page-2;o.maxPage-o.page<=2&&(e=o.maxPage-4),e=e<=0?1:e;let t=[];for(let a=e;a<=o.maxPage;a++)t.length<5&&t.push(a);return t})),order:e.sortable.order,sort:e.sortable.sort,pageOptions:e.pageOptions}),n=(0,i.Fl)((()=>{let t=o.order,a=1;"desc"===o.sort&&(a=-1);let l=e.rows;l.sort(((e,i)=>e[t]<i[t]?-1*a:e[t]>i[t]?a:0));let s=[];for(let e=o.offset-1;e<o.limit;e++)l[e]&&s.push(l[e]);return(0,i.Y3)((function(){_()})),s})),g=(0,Ce.iH)([]);e.hasCheckbox&&((0,i.Xn)((()=>{g.value=[]})),(0,i.YP)((()=>o.isCheckAll),(e=>{let a=[];g.value.forEach((t=>{t&&(t.checked=e,t.checked&&a.push(t.value))})),t("return-checked-rows",a)})));const r=()=>{let e=[];g.value.forEach((t=>{t&&t.checked&&e.push(t.value)})),t("return-checked-rows",e)},c=()=>{g.value.forEach((e=>{e&&e.checked&&(e.checked=!1)})),t("return-checked-rows",[])},d=a=>{let i="asc";a==o.order&&"asc"==o.sort&&(i="desc");let l=(o.page-1)*o.pageSize,s=o.pageSize;o.order=a,o.sort=i,t("do-search",l,s,a,i),o.isCheckAll?o.isCheckAll=!1:e.hasCheckbox&&c()},p=(a,i)=>{o.isCheckAll=!1;let l=o.order,s=o.sort,n=(a-1)*o.pageSize,g=o.pageSize;(!e.isReSearch||a>1||a==i)&&t("do-search",n,g,l,s)};(0,i.YP)((()=>o.page),p),(0,i.YP)((()=>e.page),(e=>{e<=1?(o.page=1,t("get-now-page",o.page)):e>=o.maxPage?(o.page=o.maxPage,t("get-now-page",o.page)):o.page=e}));const h=()=>{1===o.page?p(o.page,o.page):(o.page=1,o.isCheckAll=!1)};(0,i.YP)((()=>o.pageSize),h);const u=()=>{if(1==o.page)return!1;o.page--},m=e=>{o.page=e},v=()=>{if(o.page>=o.maxPage)return!1;o.page++};(0,i.YP)((()=>e.rows),(()=>{(e.isReSearch||e.isStaticMode)&&(o.page=1),(0,i.Y3)((function(){e.isStaticMode||_()}))}));const b=(e,...t)=>e.replace(/{(\d+)}/g,(function(e,a){return"undefined"!=typeof t[a]?t[a]:e})),_=()=>{if(l.value){let e=l.value.getElementsByClassName("is-rows-el");t("is-finished",e)}t("get-now-page",o.page)};return(0,i.bv)((()=>{(0,i.Y3)((()=>{e.rows.length>0&&_()}))})),e.hasCheckbox?{slots:a,localTable:l,localRows:n,setting:o,rowCheckbox:g,checked:r,doSort:d,prevPage:u,movePage:m,nextPage:v,stringFormat:b}:{slots:a,localTable:l,localRows:n,setting:o,doSort:d,prevPage:u,movePage:m,nextPage:v,stringFormat:b}}}),Se=a(8118);const Pe=(0,Se.Z)(qe,[["render",xe],["__scopeId","data-v-d8b63abc"]]);var Re=Pe,Ee=Re,ze=a(6061);_.vI.add(w.G_j);var Me={name:"OpenwbChargeLog",components:{Vue3TableLite:Ee,FontAwesomeIcon:f.GN},mixins:[ze.Z],emits:["sendCommand"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/chargepoint/+/config","openWB/vehicle/+/name"],currentMonth:"",chargeLogRequestData:{month:"",year:"",filter:{chargepoint:{id:[]},vehicle:{id:[],chargemode:[],prio:void 0}}},table:{messages:{pagingInfo:"Einträge {0}-{1} von {2}",pageSizeChangeLabel:"Einträge:",gotoPageLabel:" Gehe zu:",noDataAvailable:"Keine Einträge gefunden."},pageOptions:[{value:5,text:"5"},{value:10,text:"10"},{value:25,text:"25"},{value:50,text:"50"},{value:100,text:"100"}],columns:[{label:"Beginn",field:"time_begin",sortable:!0},{label:"Ende",field:"time_end",sortable:!0},{label:"Fahrzeug",field:"vehicle_name",sortable:!0},{label:"Dauer",field:"time_time_charged",sortable:!0,display:e=>this.alignEnd(e.time_time_charged)},{label:"Energie",field:"data_charged_since_plugged_counter",sortable:!0,display:e=>this.alignEnd(this.formatNumber(e.data_charged_since_plugged_counter/1e3,2)+"&nbsp;kWh / "+this.formatNumber(e.data_range_charged/1e3,0)+"&nbspkm")},{label:"Kosten",field:"data_costs",sortable:!0,display:e=>this.alignEnd(this.formatNumber(e.data_costs/1e3,2)+"&nbsp;€")},{label:"Lademodus",field:"vehicle_chargemode",sortable:!0,display:e=>'<div class="td-center tag '+this.getChargeModeClass(e.vehicle_chargemode)+'">'+e.vehicle_chargemode+"</div>"},{label:"Ladepunkt",field:"chargepoint_name",sortable:!0},{label:"Priorität",field:"vehicle_prio",display:e=>this.translateBool(e.vehicle_prio)}],sortable:{order:"time_begin",sort:"asc"}},totals:{columns:[{label:"Dauer",field:"time_charged",sortable:!1,display:e=>this.alignEnd(e.time_charged)},{label:"Energie",field:"charged_since_plugged_counter",sortable:!1,display:e=>this.alignEnd(this.formatNumber(e.charged_since_plugged_counter/1e3,2)+"&nbsp;kWh")},{label:"Reichweite",field:"range_charged",sortable:!1,display:e=>this.alignEnd(this.formatNumber(e.range_charged/1e3,0)+"&nbspkm")},{label:"Kosten",field:"costs",sortable:!1,display:e=>this.alignEnd(this.formatNumber(e.costs/1e3,2)+"&nbsp;€")}]}}},computed:{chargeLogDate:{get(){return this.chargeLogRequestData.year+"-"+this.chargeLogRequestData.month},set(e){let t=e.split("-");this.chargeLogRequestData.year=t[0],this.chargeLogRequestData.month=t[1]}},chargeLogTotals(){return this.$store.state.mqtt["openWB/log/"+this.mqttClientId+"/data"]?[this.$store.state.mqtt["openWB/log/"+this.mqttClientId+"/data"]["totals"]]:[]},chargeLogDataset:{get(){let e=new Intl.DateTimeFormat("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});try{return this.$store.state.mqtt["openWB/log/"+this.mqttClientId+"/data"]["entries"].map((t=>({chargepoint_id:t["chargepoint"]["id"],chargepoint_name:t["chargepoint"]["name"],vehicle_id:t["vehicle"]["id"],vehicle_name:t["vehicle"]["name"],vehicle_chargemode:this.translateChargeMode(t["vehicle"]["chargemode"]),vehicle_rfid:t["vehicle"]["rfid"],vehicle_prio:t["vehicle"]["prio"],time_begin:e.format(new Date(t["time"]["begin"])),time_end:e.format(new Date(t["time"]["end"])),time_time_charged:t["time"]["time_charged"],data_power:t["data"]["power"],data_range_charged:t["data"]["range_charged"],data_costs:t["data"]["costs"],data_charged_since_plugged_counter:t["data"]["charged_since_plugged_counter"],data_charged_since_mode_switch:t["data"]["charged_since_mode_switch"]})))}catch(t){return[]}}},chargeLogRead:{get(){return void 0!=this.chargeLogDataset}},chargeLogHasEntries:{get(){return void 0!=this.chargeLogDataset&&this.chargeLogDataset.length>0}},totalRecordCount(){return this.chargeLogDataset.length},chargeModeList(){let e=this.chargeModes.map((e=>({value:e,text:this.translateChargeMode(e)})));return e.unshift({value:void 0,text:"Alle"}),e},chargePointList(){let e=this.getWildcardTopics("openWB/chargepoint/+/config");var t=[{value:void 0,text:"Alle"}];for(const[,a]of Object.entries(e))t.push({value:a.id,text:a.name});return t},vehicleList(){let e=this.getWildcardTopics("openWB/vehicle/+/name");var t=[{value:void 0,text:"Alle"}];for(const[a,i]of Object.entries(e)){let e=parseInt(a.match(/\/([0-9]+)\/name$/)[1]);t.push({value:e,text:i})}return t}},methods:{cleanRequestData(){"id"in this.chargeLogRequestData.filter.chargepoint&&(this.chargeLogRequestData.filter.chargepoint.id=this.chargeLogRequestData.filter.chargepoint.id.filter((e=>void 0!=e))),"chargemode"in this.chargeLogRequestData.filter.vehicle&&(this.chargeLogRequestData.filter.vehicle.chargemode=this.chargeLogRequestData.filter.vehicle.chargemode.filter((e=>void 0!=e))),"id"in this.chargeLogRequestData.filter.vehicle&&(this.chargeLogRequestData.filter.vehicle.id=this.chargeLogRequestData.filter.vehicle.id.filter((e=>void 0!=e)))},requestChargeLog(){let e=document.forms["chargeLogForm"];e.reportValidity()?(this.cleanRequestData(),this.$emit("sendCommand",{command:"getChargeLog",data:this.chargeLogRequestData})):console.log("form invalid")},alignEnd(e){return'<div class="td-end">'+e+"</div>"},alignCenter(e){return'<div class="td-center">'+e+"</div>"},translateBool(e){let t="Nein",a="bg-danger";return e&&(t="Ja",a="bg-success"),'<div class="td-center tag '+a+'">'+t+"</div>"},getChargeModeClass(e){switch(e){case"Sofort":return"bg-danger";case"PV":return"bg-success";case"Zielladen":return"bg-primary";case"Standby":return"bg-secondary";case"Stop":return"bg-dark";default:return console.warn("unknown charge mode:",e),"bg-light"}},translateHeading(e){switch(e){case"time_charged":return"Dauer";case"range_charged":return"Reichweite";case"charged_since_mode_switch":return"Energie im Lademodus";case"charged_since_plugged_counter":return"Energie seit Anstecken";case"power":return"Leistung";case"costs":return"Kosten";default:return console.warn("unknown heading:",e),e}}},mounted(){const e=new Date;this.currentMonth=this.chargeLogDate=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0"),this.requestChargeLog()}};const We=(0,Se.Z)(Me,[["render",b],["__scopeId","data-v-54d89ed8"]]);var He=We}}]);
//# sourceMappingURL=ChargeLog.873114eb.js.map